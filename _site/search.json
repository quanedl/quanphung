[
  {
    "objectID": "blog.html",
    "href": "blog.html",
    "title": "p_q’s blog",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\n\n\n\nCần bao nhiêu lần xáo cho một bộ bài?\n\n\n\n\n\n\nProbability\n\n\n\nBài viết này cung cấp một cái nhìn toán học đằng sau việc xáo trộn một bộ bài. Hơn nữa là đưa ra một cơ sở để trả lời cho câu hỏi: ‘’Một bộ bài cần xáo trộn bao nhiêu lần để được coi là ngẫu nhiên?’’.\n\n\n\n\n\nFeb 1, 2024\n\n\nPhùng Minh Quân\n\n\n\n\n\n\nNo matching items\n\n Back to top"
  },
  {
    "objectID": "posts/Card Shuffling/shuffle.html",
    "href": "posts/Card Shuffling/shuffle.html",
    "title": "Cần bao nhiêu lần xáo cho một bộ bài?",
    "section": "",
    "text": "Tips\n\n\n\nMột bộ bài đi kèm có thể giúp trải nghiệm tốt hơn.",
    "crumbs": [
      "Home",
      "Posts",
      "Cần bao nhiêu lần xáo cho một bộ bài?"
    ]
  },
  {
    "objectID": "posts/Card Shuffling/shuffle.html#phân-phối-của-các-hoán-vị",
    "href": "posts/Card Shuffling/shuffle.html#phân-phối-của-các-hoán-vị",
    "title": "Cần bao nhiêu lần xáo cho một bộ bài?",
    "section": "2.1 Phân phối của các hoán vị",
    "text": "2.1 Phân phối của các hoán vị\nCụ thể, giả sử bộ bài ban đầu đang ở trạng thái \\left(1,2,\\ldots,n\\right), ta áp dụng phương pháp xáo bài Q một số lần cho bộ bài (nghĩa là, sau khi xáo theo phương pháp Q, mỗi hoán vị \\pi\\in S_{n} có xác suất Q(\\pi) để lần sắp xếp đó là sắp xếp theo \\pi). Bắt đầu bằng việc sắp xếp theo hoán vị \\varepsilon (phần tử đơn vị của nhóm \\left(S_{n},\\circ\\right)), hành động này không làm thay đổi bộ bài so với trạng thái ban đầu. Tiếp theo, chọn ngẫu nhiên một hoán vị \\pi_{1} với xác suất để \\pi_{1} được chọn là Q(\\pi_{1}) và sắp xếp lại bộ bài theo \\pi_{1}. Tiếp tục, hoán vị \\pi_{2} được chọn ngẫu nhiên với xác suất Q(\\pi_{2}) và sắp xếp lại bộ bài theo \\pi_{2}.\nBây giờ, ta xác định phân phối Q^{(2)} của \\pi_{1}\\circ\\pi_{2}. Vẫn giả sử rằng các thao tác chọn ngẫu nhiên là độc lập và các hoán vị đều được lấy từ cùng một phân phối Q. Như vậy, xác suất để chọn ngẫu nhiên được hoán vị \\pi_{1} và sau đó chọn ngẫu nhiên được hoán vị \\pi_{2} là Q(\\pi_{1})Q(\\pi_{2}). Do đó ta nhận được phân phối xác suất của \\pi_{1}\\circ\\pi_{2},\n\nQ^{(2)}(\\pi)=\\sum_{\\pi_{1}\\circ\\pi_{2}=\\pi}Q(\\pi_{1})Q(\\pi_{2}).\n\nBiểu diễn \\pi_{2}=\\pi_{1}^{-1}\\circ\\pi, trong đó \\pi_{1}^{-1} là nghịch đảo của \\pi_{1} trong \\left(S_{n},\\circ\\right). Khi đó ta có thể viết biểu thức trên dưới dạng tích chập như sau\n\nQ^{(2)}(\\pi)=(Q\\ast Q)(\\pi)=\\sum_{\\pi_{1}\\in S_{n}}Q(\\pi_{1})Q(\\pi_{1}^{-1}\\circ\\pi).\n\\tag{1}\nVới mỗi k&gt;2, quy ước\n\nQ^{(k)}(\\pi)=(Q\\ast Q^{(k-1)})(\\pi)=\\sum_{\\pi_{1}\\in S_{n}}Q(\\pi_{1})Q^{(k-1)}(\\pi_{1}^{-1}\\circ\\pi).\n\\tag{2}\nĐể ý rằng phân phối xác suất Q^{(k)} có thể được xác định chỉ dựa vào duy nhất phân phối Q^{(k-1)}. Điều này đưa ta đến một ngôn ngữ chính thức hơn, là xích Markov.",
    "crumbs": [
      "Home",
      "Posts",
      "Cần bao nhiêu lần xáo cho một bộ bài?"
    ]
  },
  {
    "objectID": "posts/Card Shuffling/shuffle.html#xích-markov",
    "href": "posts/Card Shuffling/shuffle.html#xích-markov",
    "title": "Cần bao nhiêu lần xáo cho một bộ bài?",
    "section": "2.2 Xích Markov",
    "text": "2.2 Xích Markov\nXét một dãy hữu hạn các biến ngẫu nhiên X_{0},X_{1},\\ldots,X_{k}, mỗi biến ngẫu nhiên nhận giá trị trên S_{n} và Q\\colon S_{n}\\to\\left[0,1\\right] là phân phối xác suất của các biến ngẫu nhiên X_{i}, thoả mãn Q(\\pi)\\ge0 với mọi \\pi\\in S_{n} và \\displaystyle\\sum_{\\pi\\in S_{n}}Q(\\pi)=1.\nTương tự như cách ta bắt đầu với bộ bài có trạng thái \\left(1,2,\\ldots,n\\right). Giả sử X_{0} luôn nhận giá trị là phần tử đơn vị của nhóm \\left(S_{n},\\circ\\right), tức là \\mathbb{P}(X_{0}=\\varepsilon)=1. Xem xét một số xác suất có điều kiện sau (có thể bỏ qua điều kiện X_{0}=\\varepsilon)\n\\begin{align*}\n&\\mathbb{P}(X_{1}=\\pi_{1}\\mid X_{0}=\\varepsilon)=Q(\\pi_{1}),\\\\\n&\\mathbb{P}(X_{2}=\\pi_{2}\\mid X_{0}=\\varepsilon,X_{1}=\\pi_{1})=Q^{(2)}(\\pi_{k-1}),\\\\\n&\\ldots\\\\\n&\\mathbb{P}(X_{k}=\\pi_{k}\\mid X_{0}=\\varepsilon,X_{1}=\\pi_{1},\\ldots,X_{k-1}=\\pi_{k-1})=Q^{(k)}(\\pi_{k}).\n\\end{align*}\nKết hợp với (1) và (2), với mỗi k\\ge2, ta thấy rằng\n\nQ^{(k)}(\\pi_{k})=\\sum_{\\pi\\in S_{n}}Q(\\pi)Q^{(k-1)}(\\pi^{-1}\\circ\\pi_{k}).\n\\tag{3}\nCông thức Equation 3 thể hiện xác suất Q^{(k)} chỉ phụ thuộc vào xác suất Q^{(k-1)} ngay trước nó. Suy ra, với mọi i=1,2,\\ldots,k và với mọi \\pi_{1},\\pi_{2},\\ldots,\\pi_{k}\\in S_{n},\n\n\\mathbb{P}(X_{i}=\\pi_{i}\\mid X_{0}=\\varepsilon,X_{1}=\\pi_{1},\\ldots,X_{i-1})=\\mathbb{P}(X_{i}=\\pi_{i}\\mid X_{i-1}=\\pi_{i-1}).\n\nNhư vậy việc xáo trộn (ngẫu nhiên) một bộ bài một số lần có thể được mô hình hoá thành một xích Markov.",
    "crumbs": [
      "Home",
      "Posts",
      "Cần bao nhiêu lần xáo cho một bộ bài?"
    ]
  },
  {
    "objectID": "posts/Card Shuffling/shuffle.html#khoảng-cách-biến-phân",
    "href": "posts/Card Shuffling/shuffle.html#khoảng-cách-biến-phân",
    "title": "Cần bao nhiêu lần xáo cho một bộ bài?",
    "section": "2.3 Khoảng cách biến phân",
    "text": "2.3 Khoảng cách biến phân\nGiả sử ta đã có một bộ bài được xáo trộn theo phương pháp Q một số lần. Bây giờ ta cần một phép đo để biết liệu rằng kết quả của phương pháp xáo bài này đang cách sự ngẫu nhiên bao xa. Trước hết, cần thống nhất về sự ngẫu nhiên, rằng kết quả được gọi là ngẫu nhiên nếu như mọi trạng thái của bộ bài đều có khả năng xuất hiện như nhau sau các lần xáo trộn. Để thể hiện điều này, ta gán một phân phối đều \\mathcal{U} lên S_{n}, cụ thể, \\mathcal{U}(\\pi)=\\left\\vert S_{n}\\right\\vert^{-1}=\\left(n!\\right)^{-1}. Khi đó ta có thể đồng nhất xác suất để hoán vị \\pi xuất hiện và xác suất để bộ bài ở trạng thái \\left(\\pi(1),\\pi(2),\\ldots,\\pi(n)\\right).\nỞ đây ta đưa ra một công cụ để đo sự sai khác mà trong trường hợp này là của hai phân phối xác suất. Xét hai phân phối xác suất Q_{1} và Q_{2} trên S_{n}. Khoảng cách biến phân của Q_{1} và Q_{2} được định nghĩa bởi\n\n\\left\\lVert Q_{1}-Q_{2}\\right\\rVert=\\frac{1}{2}\\sum_{\\pi\\in S_{n}}\\left\\vert Q_{1}(\\pi)-Q_{2}(\\pi)\\right\\vert.\n\nHệ số \\frac{1}{2} được thêm vào để đảm bảo khoảng cách biến phân nằm trong \\left[0,1\\right], vì\n\n\\sum_{\\pi\\in S_{n}}\\left\\vert Q_{1}(\\pi)-Q_{2}(\\pi)\\right\\vert\\le\\sum_{\\pi\\in S_{n}}\\left\\vert Q_{1}(\\pi)\\right\\vert+\\sum_{\\pi\\in S_{n}}\\left\\vert Q_{2}(\\pi)\\right\\vert\\le2.\n\nTa mong muốn đo được phân phối cuối cùng (sau k lần tích chập) của chúng ta cách phân phối đều “bao xa”, và mất “bao lâu” để Q^{(k)} đến đủ gần \\mathcal{U}. Như vậy ta cần tính được khoảng cách biến phân của hai phân phối Q^{(k)} và \\mathcal{U} trên S_{n}, chính là\n\n\\left\\lVert Q^{(k)}-\\mathcal{U}\\right\\rVert=\\frac{1}{2}\\sum_{\\pi\\in S_{n}}\\left\\vert Q^{(k)}(\\pi)-\\mathcal{U}(\\pi)\\right\\vert.",
    "crumbs": [
      "Home",
      "Posts",
      "Cần bao nhiêu lần xáo cho một bộ bài?"
    ]
  },
  {
    "objectID": "posts/Card Shuffling/shuffle.html#phương-pháp-chẻ-bài-thông-thường",
    "href": "posts/Card Shuffling/shuffle.html#phương-pháp-chẻ-bài-thông-thường",
    "title": "Cần bao nhiêu lần xáo cho một bộ bài?",
    "section": "3.1 Phương pháp chẻ bài thông thường",
    "text": "3.1 Phương pháp chẻ bài thông thường\nĐây là một phương pháp phổ biến để xáo bài. Ở đây ta chỉ cần quan tâm đến thứ tự của các lá bài thay vì các kĩ thuật thực hiện trong thực tế. Phương pháp chẻ bài thông thường có thể được mô tả như sau: Chia bộ bài gồm n lá bài thành hai phần. Giả sử phần bên trái có l lá bài (0\\le l\\le n), như vậy phần còn lại bên phải có n-l lá bài. Sau đó xen kẽ các lá bài của hai phần, theo nghĩa, gộp hai phần lại thành một bộ bài sao cho thứ tự tương đối của các lá bài trong mỗi phần không đổi. Thao tác xen kẽ này mang tính ngẫu nhiên và có biến ngẫu nhiên tương ứng tuân theo phân phối đều, tức là mỗi cách xen kẽ đều có khả năng xảy ra như nhau.\nGiả định rằng khả năng để phần bên trái có l lá bài tuân theo phân phối nhị thức \\mathcal{B}(n,2), xác suất này chính là \\binom{n}{l}2^{-n}. Mặt khác, số cách chọn l vị trí trong n vị trí cho các lá bài của phần bên trái là \\binom{n}{l}, các lá bài còn lại của phần bên phải được thêm vào n-l vị trí trống theo thứ tự được quy định trước đó, do đó có đúng một cách xếp phần bên phải vào bộ bài. Như vậy, số cách xen kẽ có thể xảy ra là \\binom{n}{l}, vì vậy, xác suất của mỗi cách xen kẽ là\n\n\\binom{n}{l}^{-1}.\n\\tag{4}\nTóm lại, xác suất của một cách chia ngẫu nhiên bộ bài thành hai phần, trong đó phần bên trái có l lá bài, và tiếp theo là một cách xen kẽ ngẫu nhiên đồng đều hai phần lại với nhau, chính là\n\n\\binom{n}{l}2^{-n}\\cdot\\binom{n}{l}^{-1}=\\frac{1}{2^{n}}.\n\nXác suất này hoàn toàn không phụ thuộc vào l, nghĩa là, các cặp gồm một cách phân chia bộ bài thành hai phần và một cách xen kẽ hai phần lại với nhau đều có cùng một khả năng xảy ra. Hơn nữa ta thấy rằng, mỗi một cặp cắt - xen kẽ như vậy là một sự sắp xếp lại thứ tự của bộ bài một cách ngẫu nhiên, hay nói cách khác, tương ứng với một lần xáo bài. Gọi phương pháp (phân phối) chẻ bài thông thường này là \\mathcal{R}.\nTa xem xét một cách tiếp cận khác cho quá trình xen kẽ. Giả sử bộ bài được chia thành hai phần. Ở mỗi lượt, một lá bài bị thả xuống từ một phần bài nào đó. Xác suất để lá bị thả ở lượt đó đến từ phần có l_{1} lá là \\frac{l_{1}}{n} và đến từ phần có l_{2} lá là \\frac{l_{2}}{n}. Nghĩa là phần bên nào đang có nhiều bài thì càng có khả năng bị thả xuống. Giả định này có vẻ không mâu thuẫn với cảm giác cầm và thả bài trong thực tế. Việc chứng minh cách xen kẽ này tương đương với phía trên sẽ được đề cập một cách tổng quát ở mục 3.2.2.\nỞ bước phân chia bộ bài thành hai phần, ta đã xem phân phối của vị trí nhát cắt tuân theo phân phối nhị thức. Giả định này có phần hợp lý. Bởi lẽ người ta có xu hướng ‘’cắt’’ tại vị trí ở gần chính giữa bộ bài hơn là ‘’cắt’’ tại các vị trí ở gần trên hoặc dưới cùng. Mỗi nhát cắt có thể được coi như một biến ngẫu nhiên, các biến ngẫu nhiên này là độc lập và được lấy từ phân phối nhị thức \\mathcal{B}(n,2).\n\n\nHiển thị mã\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.stats import binom\nfrom scipy.stats.sampling import DiscreteAliasUrn\n\ndef plot_binomial_distribution(n, p, num_samples):\n    k_values = np.arange(n + 1)\n    pmf_values = binom.pmf(k_values, n, p)\n    \n    sampler = DiscreteAliasUrn(pmf_values)\n    samples = sampler.rvs(size=num_samples)\n    \n    plt.figure(figsize=(10, 5))\n    plt.stem(k_values, pmf_values, linefmt=\"blue\", markerfmt=\"bo\", basefmt=\" \", label=\"Theoretical PMF\")\n    plt.hist(samples, bins=np.arange(-0.5, n + 1.5, 1), density=True,\n             color=\"lightgreen\", edgecolor='green', alpha=0.6, label=\"Sampled Data\")\n    plt.xlabel(\"Value of l\")\n    plt.ylabel(\"Probability B(l; n, p)\")\n    plt.title(f\"Probability Mass Function and {num_samples} Random Samples\")\n    plt.legend()\n    plt.show()\n\nif __name__ == \"__main__\":\n    n = 52\n    p = 0.5\n    num_samples = 3000\n    plot_binomial_distribution(n, p, num_samples)\n\n\n\n\n\n\n\n\n\nTa cũng mong muốn biết được sau k lần chẻ bài ngẫu nhiên thì ta cách bao xa so với thời điểm mà mọi trạng thái của bộ bài đều có cùng một khả năng xảy ra, tức là cần tính được khoảng cách biến phân của \\mathcal{R}^{(k)} và \\mathcal{U},\n\n\\left\\lVert\\mathcal{R}^{(k)}-\\mathcal{U}\\right\\rVert=\\frac{1}{2}\\sum_{\\pi\\in S_{n}}\\left\\vert\\mathcal{R}^{(k)}(\\pi)-\\mathcal{U}(\\pi)\\right\\vert.\n\nViệc tính toán trực tiếp đại lượng trên là một quá trình nhọc nhằn với con người, và đủ phức tạp kể cả với hầu hết các máy tính nếu n đủ lớn (có đến n! tổng cần tính toán!).",
    "crumbs": [
      "Home",
      "Posts",
      "Cần bao nhiêu lần xáo cho một bộ bài?"
    ]
  },
  {
    "objectID": "posts/Card Shuffling/shuffle.html#phương-pháp-a-chẻ-bài",
    "href": "posts/Card Shuffling/shuffle.html#phương-pháp-a-chẻ-bài",
    "title": "Cần bao nhiêu lần xáo cho một bộ bài?",
    "section": "3.2 Phương pháp a-chẻ bài",
    "text": "3.2 Phương pháp a-chẻ bài\n\n3.2.1 Dãy tăng\nĐầu tiên ta định nghĩa một dãy tăng trong một trạng thái của bộ bài (có thể đồng nhất với dãy tăng trong một hoán vị theo nghĩa là trạng thái ngay sau khi thực hiện hoán vị đó cho trạng thái \\left(1,2,\\ldots,n\\right)). Giả sử ta có một bộ bài n lá đang ở trạng thái \\left(1,2,\\ldots,n\\right). Sau đó thực hiện một hoán vị \\pi\\in S_{n} nào đó chuyển bộ bài sang trạng thái \\left(\\sigma(1),\\sigma(2),\\ldots,\\sigma(n)\\right). Chọn một lá x\\in\\llbracket n\\rrbracket bất kì trong bộ bài. Ta thực hiện hai hành động sau đây\n\nBắt đầu từ lá bài ngay bên trên x, tìm lá x+1. Nếu tìm thấy lá x+1, bắt đầu từ lá bài ngay bên trên x+1, tìm lá x+2. Quá trình tìm kiếm dừng lại khi không thể tìm được lá bài thoả mãn.\nBắt đầu từ lá bài ngay bên dưới x, tìm lá x-1. Nếu tìm thấy lá x-1, bắt đầu từ lá bài ngay bên dưới x-1, tìm lá x-2. Quá trình tìm kiếm dừng lại khi không thể tìm được lá bài thoả mãn.\n\nDĩ nhiên hai quá trình trên sẽ dừng lại sau một số hữu hạn thao tác. Khi đó, ta nhận được chính xác một dãy tăng liên tục x-i,x-i+1,\\ldots,x,\\ldots,x+j-1,x+j. Có thể xem đây là một dãy con của dãy 1,2,\\ldots,n.\nTiếp tục chọn bất kì một lá y (nếu có thể) và thực hiện hai hành động tương tự như lá x. Kết quả nhận được sau toàn bộ thao tác (chọn và tìm) chính là các dãy con, tăng và liên tục của dãy 1,2,\\ldots,n. Hơn nữa, chúng chính là một phân hoạch của 1,2,\\ldots,n.\n\n\n3.2.2 a-chẻ bài\nCó nhiều mô tả tương đương (theo nghĩa cùng cho ra một phân phối của các hoán vị) cho phương pháp a-chẻ bài, một tổng quát hoá của phương pháp chẻ bài thông thường. Ta sẽ xem xét một số hướng tiếp cận phương pháp này.\nVới a là một số nguyên dương. Chia bộ bài gồm n lá bài thành a phần, mỗi phần có số lá bài lần lượt là l_{1},l_{2},\\ldots,l_{a}, trong đó l_{i}\\ge0 với mọi i=1,2,\\ldots,a và l_{1}+l_{2}+\\ldots+l_{a}=n. Sau đó xen kẽ các lá bài của a phần này với nhau, theo nghĩa, gộp a phần lại thành một bộ bài sao cho thứ tự tương đối của các lá bài trong mỗi phần không thay đổi.\nHành động phân chia bộ bài bên trên tuân theo phân phối đa thức (một phiên bản tổng quát của phân phối nhị thức). Nói cách khác, xác suất để các phần có số lá bài lần lượt là l_{1},l_{2},\\ldots,l_{a}, chính bằng\n\n\\binom{n}{l_{1},l_{2},\\ldots,l_{a}}a^{-n}=\\frac{n!}{l_{1}!l_{2}!\\cdots l_{a}!}a^{-n}.\n\nTa thực hiện tiếp tục xen kẽ a phần này theo cách, mỗi lần, thả một lá bài ở dưới cùng của một phần nào đó (lá bài được thả ở lần ngay sau đó nằm ngay trên lá bài vừa được thả ở lần trước), trong đó khả năng để lá bài được thả xuống ở một lần nào đó đến từ phần i là\n\n\\frac{l_{i}}{l_{1}+l_{2}+\\ldots+l_{a}}.\n\\tag{5}\nỞ mỗi lần, biểu thức (5) sẽ được cập nhật dựa trên sự thay đổi của số lá bài hiện có trong mỗi phần. Đơn cử, xét trường hợp các lá bài trong mỗi phần được thả liên tiếp, lần lượt từ phần 1 đến phần a. Khi đó xác suất của l_{1} lần thả đầu tiên là\n\n\\frac{l_{1}}{n}\\cdot\\frac{l_{1}-1}{n-1}\\cdots\\frac{1}{n-l_{1}+1}=\\frac{l_{1}\\left(l_{1}-1\\right)\\cdots1}{n\\left(n-1\\right)\\cdots\\left(n-l_{1}+1\\right)}.\n\nTương tự, xác suất của n-l_{1} lần thả còn lại là\n\n\\prod_{i=2}^{a}\\frac{l_{i}\\left(l_{i}-1\\right)\\cdots1}{\\left(n-l_{1}-l_{2}-\\ldots-l_{i-1}\\right)\\left(n-l_{1}-l_{2}-\\ldots-l_{i-1}-1\\right)\\cdots\\left(n-l_{1}-l_{2}-\\ldots-l_{i}+1\\right)}.\n\nNhớ rằng l_{1}+l_{2}+\\ldots+l_{a}=n. Như vậy xác suất của toàn bộ quá trình thả bài, chính bằng\n\n\\frac{\\left(l_{1}\\left(l_{1}-1\\right)\\cdots1\\right)\\left(l_{2}\\left(l_{2}-1\\right)\\cdots1\\right)\\cdots\\left(l_{a}\\left(l_{a}-1\\right)\\cdots1\\right)}{n\\left(n-1\\right)\\cdots1}=\\frac{l_{1}!l_{2}!\\cdots l_{a}!}{n!}.\n\\tag{6}\nTrong trường hợp thứ tự của các lá bài của a phần trong các lần thả thay đổi, xác suất cuối cùng vẫn giữ nguyên. Bởi, khi ta thay đổi thứ tự thả xuống của hai lá bài, bản chất chỉ là đang thay đổi thứ tự các nhân tử ở tử số của phân thức (6).\nMột cách suy diễn tương đương khác để dẫn đến xác suất trên. Đó là sau khi chọn theo phân phối đa thức một cách phân chia bộ bài thành a phần, sau đó lấy lần lượt, bất kỳ, hai phần khác nhau và thực hiện xen kẽ hai phần này thành một bộ, tức xem như chẻ bài thông thường cho một bộ bài. Thao tác tương tự cho những cặp khác. Sau a-1 lần thực hiện chẻ bài thông thường cho mỗi bộ hai phần, ta nhận được bộ bài gồm n lá ban đầu. Ta sẽ chứng minh rằng hướng tiếp cận này tương đương với quá trình thả bài phía trên, theo nghĩa, xác suất cuối cùng của hai cách này là như nhau. Thật vậy, giả sử rằng ta chọn các cặp của các phần theo thứ tự: phần 1 và phần 2, tiếp theo là phần 1, 2 và phần 3, sau đó là phần 1, 2, 3 và phần 4,… Tương tự cho đến cặp cuối cùng. Sử dụng công thức xác suất (4), ta nhận được xác suất của toàn bộ a-1 lần thực hiện chẻ bài thông thường là\n\\begin{align*}\n&\\binom{l_{1}+l_{2}}{l_{2}}^{-1}\\binom{l_{1}+l_{2}+l_{3}}{l_{3}}^{-1}\\cdots\\binom{l_{1}+l_{2}+\\ldots+l_{a}}{l_{a}}^{-1}\\\\\n=&\\left(\\frac{\\left(l_{1}+l_{2}\\right)!}{l_{1}!l_{2}!}\\cdot\\frac{\\left(l_{1}+l_{2}+l_{3}\\right)!}{\\left(l_{1}+l_{2}\\right)!l_{3}!}\\cdots\\frac{\\left(l_{1}+l_{2}+\\ldots+l_{a}\\right)!}{\\left(l_{1}+l_{2}+\\ldots+l_{a-1}\\right)!l_{a}!}\\right)^{-1}\\\\\n=&\\left(\\frac{\\left(l_{1}+l_{2}+\\ldots+l_{a}\\right)!}{l_{1}!l_{2}!\\cdots l_{a}!}\\right)^{-1}\\\\\n=&\\frac{l_{1}!l_{2}!\\cdots l_{a}!}{n!}.\n\\end{align*}\nNhư vậy hai cách tiếp cận trên là tương đương. Cuối cùng, xác suất để chọn được một cách phân chia và xen kẽ thoả mãn các điều kiện phía trên, chính là\n\n\\binom{n}{l_{1},l_{2},\\ldots,l_{a}}a^{-n}\\cdot\\frac{l_{1}!l_{2}!\\cdots l_{a}!}{n!}=\\frac{1}{a^{n}}.\n\\tag{7}\nNhư vậy, mỗi cặp phân chia - xen kẽ ở phương pháp a-chẻ bài cũng tuân theo phân phối đều và bản chất cũng là một lần xáo bài. Ta gọi phương pháp a-chẻ bài này là \\mathcal{R}_{a}, với phân phối xác suất \\mathcal{R}_{a} tương ứng. Dễ thấy \\mathcal{R}_{2}=\\mathcal{R}, nói cách khác phương pháp chẻ bài thông thường chính là phương pháp 2-chẻ bài.\n\n\n3.2.3 Định lý nhân và định lý dãy tăng\n\nĐịnh lý 1\nVới a,b là các số tự nhiên, thực hiện một lần a-chẻ bài và sau đó là một lần b-chẻ bài tương đương với việc thực hiện một lần ab-chẻ bài. Cụ thể, giả sử \\mathcal{R}_{a}, \\mathcal{R}_{b}, \\mathcal{R}_{ab} lần lượt là phân phối của a-chẻ bài, b-chẻ bài, ab-chẻ bài. Khi đó \\mathcal{R}_{a}\\ast\\mathcal{R}_{b}=\\mathcal{R}_{ab}.\n\n\nProof. Xem xét một mô tả tương đương sau của phương pháp a-chẻ bài. Phương pháp này có thể được mô tả một cách hình học như việc thả độc lập, ngẫu nhiên theo phân phối đều n điểm vào đoạn thẳng đơn vị \\left[0,1\\right], sau đó tác động ánh xạ x\\mapsto ax\\pmod1, đi từ \\left[0,1\\right] vào chính nó. Ánh xạ này hoán vị n điểm ban đầu và bảo toàn độ đo trên \\left(S_{n},\\circ\\right). Số lượng điểm rơi vào các đoạn \\left[0,\\frac{1}{a}\\right], \\left[\\frac{1}{a},\\frac{2}{a}\\right], …, \\left[\\frac{a-1}{a},1\\right] tuân theo phân phối đa thức. Định lý được chứng minh nhờ tính chất sau\n\nb\\left(ax\\!\\pmod1\\right)\\!\\pmod1=abx\\!\\pmod1.\n\n\nVì một lần chẻ bài thông thường là một lần 2-chẻ bài, do đó thay vì cố gắng xác định chính xác tích chập \\mathcal{R}^{(k)} của k lần phân phối \\mathcal{R}, ta chỉ cần tính toán cho một lần 2^{k}-chẻ bài duy nhất, ứng với phân phối \\mathcal{R}_{2^{k}}.\n\nĐịnh lý 2\nXác suất nhận được hoán vị \\pi\\in S_{n} khi thực hiện một lần a-chẻ bài là\n\n\\frac{1}{a^{n}}\\binom{a+n-r_{\\pi}}{n},\n với r_{\\pi} là số dãy tăng trong \\pi.\n\n\nProof. Giả sử ta nhận được hoán vị \\pi sau một lần a-chẻ bài, tức là sau một lần phân chia và một lần xen kẽ nào đó. Xét một cách phân chia trong số đó, lúc này chỉ có duy nhất một cách để cách xen kẽ a phần này lại với nhau (vì với bất kì cách chia nào của bộ bài, ta chỉ cần thả các lá bài ở a phần theo thứ tự của hoán vị \\pi). Ta đếm số cách phân chia bộ bài thành a phần mà sau đó có thể xen kẽ lại với nhau và nhận được hoán vị \\pi. Nếu có r_{\\pi} dãy tăng trong \\pi, ta biết được chắc chắn r_{\\pi}-1 trong số a-1 nhát cắt để đảm bảo nhận được hoán vị \\pi sau khi xen kẽ. Ta chọn vị trí của a-1-\\left(r_{\\pi}-1\\right)=a-r_{\\pi} nhát cắt còn lại giữa bộ bài n lá, dễ thấy có \\binom{n+a-r_{\\pi}}{a-r_{\\pi}} lựa chọn như vậy (bài toán chia kẹo Euler). Từ (7) ta thấy xác suất xảy ra của mỗi hoán vị là a^{-n}. Vậy xác suất để nhận được hoán vị \\pi, có r_{\\pi} dãy tăng, sau khi thực hiện một lần a-chẻ bài là\n\n\\binom{n+a-r_{\\pi}}{a-r_{\\pi}}\\cdot a^{-n}=\\frac{1}{a^{n}}\\binom{a+n-r_{\\pi}}{n}.\n\n\nMột lợi thế khác khi ta quan tâm đến các a-chẻ bài là sau khi thực hiện một lần a-chẻ bài, khả năng xuất hiện của hoán vị \\pi\\in S_{n} có thể được tính toán chỉ với duy nhất thông tin về số dãy tăng r_{\\pi} trong \\pi.",
    "crumbs": [
      "Home",
      "Posts",
      "Cần bao nhiêu lần xáo cho một bộ bài?"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Quan Phung",
    "section": "",
    "text": "Nothing here for now—gotta save my spine first!\n\n\n\n Back to top"
  }
]