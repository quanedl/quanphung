<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phùng Minh Quân">

<title>Cần bao nhiêu lần xáo cho một bộ bài? – Quan Phung</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../lee.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-e25cc82807363e79c52e96bc8b7855f1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-32fef9a9834a802835b9e1f0e56d916b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../assets/styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../lcat.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Quan Phung</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/Card Shuffling/shuffle.html">Posts</a></li><li class="breadcrumb-item"><a href="../../posts/Card Shuffling/shuffle.html">Cần bao nhiêu lần xáo cho một bộ bài?</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Card Shuffling/shuffle.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Cần bao nhiêu lần xáo cho một bộ bài?</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Mục lục</h2>
   
  <ul>
  <li><a href="#hoán-vị-và-sự-sắp-xếp-lại" id="toc-hoán-vị-và-sự-sắp-xếp-lại" class="nav-link active" data-scroll-target="#hoán-vị-và-sự-sắp-xếp-lại"><span class="header-section-number">1</span> Hoán vị và sự sắp xếp lại</a></li>
  <li><a href="#xáo-bài" id="toc-xáo-bài" class="nav-link" data-scroll-target="#xáo-bài"><span class="header-section-number">2</span> Xáo bài</a>
  <ul class="collapse">
  <li><a href="#phân-phối-của-các-hoán-vị" id="toc-phân-phối-của-các-hoán-vị" class="nav-link" data-scroll-target="#phân-phối-của-các-hoán-vị"><span class="header-section-number">2.1</span> Phân phối của các hoán vị</a></li>
  <li><a href="#xích-markov" id="toc-xích-markov" class="nav-link" data-scroll-target="#xích-markov"><span class="header-section-number">2.2</span> Xích Markov</a></li>
  <li><a href="#khoảng-cách-biến-phân" id="toc-khoảng-cách-biến-phân" class="nav-link" data-scroll-target="#khoảng-cách-biến-phân"><span class="header-section-number">2.3</span> Khoảng cách biến phân</a></li>
  </ul></li>
  <li><a href="#phương-pháp-chẻ-bài" id="toc-phương-pháp-chẻ-bài" class="nav-link" data-scroll-target="#phương-pháp-chẻ-bài"><span class="header-section-number">3</span> Phương pháp chẻ bài</a>
  <ul class="collapse">
  <li><a href="#phương-pháp-chẻ-bài-thông-thường" id="toc-phương-pháp-chẻ-bài-thông-thường" class="nav-link" data-scroll-target="#phương-pháp-chẻ-bài-thông-thường"><span class="header-section-number">3.1</span> Phương pháp chẻ bài thông thường</a></li>
  <li><a href="#phương-pháp-a-chẻ-bài" id="toc-phương-pháp-a-chẻ-bài" class="nav-link" data-scroll-target="#phương-pháp-a-chẻ-bài"><span class="header-section-number">3.2</span> Phương pháp <span class="math inline">a</span>-chẻ bài</a>
  <ul class="collapse">
  <li><a href="#dãy-tăng" id="toc-dãy-tăng" class="nav-link" data-scroll-target="#dãy-tăng"><span class="header-section-number">3.2.1</span> Dãy tăng</a></li>
  <li><a href="#sec-a-shuffle" id="toc-sec-a-shuffle" class="nav-link" data-scroll-target="#sec-a-shuffle"><span class="header-section-number">3.2.2</span> <span class="math inline">a</span>-chẻ bài</a></li>
  <li><a href="#định-lý-nhân-và-định-lý-dãy-tăng" id="toc-định-lý-nhân-và-định-lý-dãy-tăng" class="nav-link" data-scroll-target="#định-lý-nhân-và-định-lý-dãy-tăng"><span class="header-section-number">3.2.3</span> Định lý nhân và định lý dãy tăng</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cần-ít-nhất-bao-nhiêu-lần-xáo-bài" id="toc-cần-ít-nhất-bao-nhiêu-lần-xáo-bài" class="nav-link" data-scroll-target="#cần-ít-nhất-bao-nhiêu-lần-xáo-bài"><span class="header-section-number">4</span> Cần ít nhất bao nhiêu lần xáo bài?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/Card Shuffling/shuffle.html">Posts</a></li><li class="breadcrumb-item"><a href="../../posts/Card Shuffling/shuffle.html">Cần bao nhiêu lần xáo cho một bộ bài?</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Cần bao nhiêu lần xáo cho một bộ bài?</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Probability</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phùng Minh Quân </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Feb 1, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">Feb 2, 2025</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    Bài viết này cung cấp một cái nhìn toán học đằng sau việc xáo trộn một bộ bài. Hơn nữa là đưa ra một cơ sở để trả lời cho câu hỏi: ‘’Một bộ bài cần xáo trộn bao nhiêu lần để được coi là ngẫu nhiên?’’.
  </div>
</div>


</header>


<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tips
</div>
</div>
<div class="callout-body-container callout-body">
<p>Một bộ bài đi kèm có thể giúp trải nghiệm tốt hơn.</p>
</div>
</div>
<section id="hoán-vị-và-sự-sắp-xếp-lại" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Hoán vị và sự sắp xếp lại</h1>
<p>Trước tiên ta cần định nghĩa một số khái niệm. Với mỗi <span class="math inline">n\in\mathbb{N}^{*}</span>, kí hiệu <span class="math inline">\llbracket n\rrbracket</span> là tập tất cả các số tự nhiên từ <span class="math inline">1</span> đến <span class="math inline">n</span>.</p>
<p><strong>Định nghĩa 1.</strong> Với mỗi <span class="math inline">n\in\mathbb{N}^{*}</span>, một hoán vị <span class="math inline">\sigma</span> là một song ánh <span class="math inline">\sigma\colon\llbracket n\rrbracket\to\llbracket n\rrbracket</span>.</p>
<p>Kí hiệu tập tất cả các hoán vị (trên tập <span class="math inline">\llbracket n\rrbracket</span>) là <span class="math inline">S_{n}</span>. Dễ thấy rằng <span class="math inline">\left\vert S_{n}\right\vert=n!</span>. Hơn nữa, hoán vị <span class="math inline">\sigma\colon\llbracket n\rrbracket\to\llbracket n\rrbracket</span> có thể được viết dưới dạng</p>
<p><span class="math display">
\sigma=
\begin{pmatrix}
1 &amp; 2 &amp; 3 &amp; \ldots &amp; n\\
\sigma(1) &amp; \sigma(2) &amp; \sigma(3) &amp; \ldots &amp; \sigma(n).
\end{pmatrix}
</span></p>
<p>Hoặc chỉ gồm dòng thứ hai <span class="math inline">\sigma=\left(\sigma(1),\sigma(2),\ldots,\sigma(n)\right)</span>, trong đó hiểu rằng dòng đầu tiên được viết theo thứ tự tăng dần từ <span class="math inline">1</span> đến <span class="math inline">n</span>.</p>
<p>Bây giờ ta có một bộ bài gồm <span class="math inline">n</span> lá bài, mỗi lá được gán nhãn lần lượt từ <span class="math inline">1</span> đến <span class="math inline">n</span>. Một trạng thái của bộ bài là một bộ có thứ tự các lá bài <span class="math inline">\left(x_{1},x_{2},\ldots,x_{n}\right)</span>, trong đó <span class="math inline">x_{i}\in\llbracket n\rrbracket</span> và các lá bài trong bộ bài cũng theo thứ tự đó từ dưới lên trên. Việc sắp xếp lại thứ tự của <span class="math inline">n</span> lá bài này chỉ là sự thay đổi thứ tự các phần tử của <span class="math inline">\llbracket n\rrbracket</span> thành một thứ tự khác, nói cách khác, chính là một hoán vị.</p>
<p>Như vậy ta biết rằng một hoán vị sẽ tương ứng với một sự sắp xếp lại bộ bài nào đó (về sau ta gọi vắn tắt một lần sắp xếp lại thứ tự bộ bài tương ứng với hoán vị <span class="math inline">\sigma</span> là sắp theo <span class="math inline">\sigma</span>). Giả sử có hai lần sắp theo <span class="math inline">\pi</span> và <span class="math inline">\tau</span>. Ta sẽ chỉ ra rằng khi thực hiện lần lượt lần sắp theo <span class="math inline">\pi</span>, và tiếp sau đó là sắp theo <span class="math inline">\tau</span>, thì kết quả sẽ là một sự sắp theo <span class="math inline">\pi\circ\tau</span>. Thực vậy, với mỗi <span class="math inline">i,j\in\llbracket n\rrbracket</span>, sắp theo <span class="math inline">\pi</span> làm lá bài đang ở vị trí thứ <span class="math inline">\pi(i)</span> chuyển sang vị trí thứ <span class="math inline">i</span>, tiếp sau đó là sắp theo <span class="math inline">\tau</span> làm lá bài đang ở vị trí thứ <span class="math inline">\tau(j)</span> chuyển sang vị trí thứ <span class="math inline">j</span>. Cho <span class="math inline">i=\tau(j)</span>, sau hai lần sắp xếp, lá bài ban đầu ở vị trí thứ <span class="math inline">\pi(i)=\pi(\tau(j))</span> chuyển sang vị trí thứ <span class="math inline">j</span>, hay chính là một lần sắp theo <span class="math inline">\pi\circ\tau</span>.</p>
<p>Ta biết rằng tập <span class="math inline">S_{n}</span> các hoán vị cùng với phép toán hợp thành <span class="math inline">\circ</span> lập thành một nhóm. Nhóm <span class="math inline">\left(S_{n},\circ\right)</span> không giao hoán với <span class="math inline">n\ge3</span>. Do đó, nói chung, kết quả của việc thực hiện liên tiếp hai lần sắp xếp là khác nhau nếu ta thay đổi thứ tự của các lần sắp xếp.</p>
<p>Cần lưu ý mỗi hoán vị thể hiện cách một bộ bài thay đổi từ trạng thái này sang trạng thái khác. Chúng không thể hiện trực tiếp trạng thái trước hoặc sau khi sắp xếp của bộ bài (một trường hợp đặc biệt khi bộ bài đang ở trạng thái <span class="math inline">\left(1,2,\ldots,n\right)</span>, lúc này trạng thái của bộ bài ngay sau khi được sắp xếp lại theo hoán vị <span class="math inline">\sigma</span> là <span class="math inline">\left(\sigma(1),\sigma(2),\ldots,\sigma(n)\right)</span>).</p>
</section>
<section id="xáo-bài" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Xáo bài</h1>
<p>Tiếp theo, ta bổ sung yếu tố ‘’ngẫu nhiên’’ vào quá trình sắp xếp lại bộ bài. Ta có thể xem việc xáo bài (về trực giác, là một thao tác sắp xếp lại bộ bài một cách ngẫu nhiên) như một phân phối xác suất cho tương ứng mỗi cách sắp xếp lại bộ bài với xác suất (khả năng xuất hiện) của nó.</p>
<section id="phân-phối-của-các-hoán-vị" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="phân-phối-của-các-hoán-vị"><span class="header-section-number">2.1</span> Phân phối của các hoán vị</h2>
<p>Cụ thể, giả sử bộ bài ban đầu đang ở trạng thái <span class="math inline">\left(1,2,\ldots,n\right)</span>, ta áp dụng phương pháp xáo bài <span class="math inline">Q</span> một số lần cho bộ bài (nghĩa là, sau khi xáo theo phương pháp <span class="math inline">Q</span>, mỗi hoán vị <span class="math inline">\pi\in S_{n}</span> có xác suất <span class="math inline">Q(\pi)</span> để lần sắp xếp đó là sắp xếp theo <span class="math inline">\pi</span>). Bắt đầu bằng việc sắp xếp theo hoán vị <span class="math inline">\varepsilon</span> (phần tử đơn vị của nhóm <span class="math inline">\left(S_{n},\circ\right)</span>), hành động này không làm thay đổi bộ bài so với trạng thái ban đầu. Tiếp theo, chọn ngẫu nhiên một hoán vị <span class="math inline">\pi_{1}</span> với xác suất để <span class="math inline">\pi_{1}</span> được chọn là <span class="math inline">Q(\pi_{1})</span> và sắp xếp lại bộ bài theo <span class="math inline">\pi_{1}</span>. Tiếp tục, hoán vị <span class="math inline">\pi_{2}</span> được chọn ngẫu nhiên với xác suất <span class="math inline">Q(\pi_{2})</span> và sắp xếp lại bộ bài theo <span class="math inline">\pi_{2}</span>.</p>
<p>Bây giờ, ta xác định phân phối <span class="math inline">Q^{(2)}</span> của <span class="math inline">\pi_{1}\circ\pi_{2}</span>. Vẫn giả sử rằng các thao tác chọn ngẫu nhiên là độc lập và các hoán vị đều được lấy từ cùng một phân phối <span class="math inline">Q</span>. Như vậy, xác suất để chọn ngẫu nhiên được hoán vị <span class="math inline">\pi_{1}</span> và sau đó chọn ngẫu nhiên được hoán vị <span class="math inline">\pi_{2}</span> là <span class="math inline">Q(\pi_{1})Q(\pi_{2})</span>. Do đó ta nhận được phân phối xác suất của <span class="math inline">\pi_{1}\circ\pi_{2}</span>,</p>
<p><span class="math display">
Q^{(2)}(\pi)=\sum_{\pi_{1}\circ\pi_{2}=\pi}Q(\pi_{1})Q(\pi_{2}).
</span></p>
<p>Biểu diễn <span class="math inline">\pi_{2}=\pi_{1}^{-1}\circ\pi</span>, trong đó <span class="math inline">\pi_{1}^{-1}</span> là nghịch đảo của <span class="math inline">\pi_{1}</span> trong <span class="math inline">\left(S_{n},\circ\right)</span>. Khi đó ta có thể viết biểu thức trên dưới dạng tích chập như sau</p>
<p><span id="eq-k_equal_2"><span class="math display">
Q^{(2)}(\pi)=(Q\ast Q)(\pi)=\sum_{\pi_{1}\in S_{n}}Q(\pi_{1})Q(\pi_{1}^{-1}\circ\pi).
\tag{1}</span></span></p>
<p>Với mỗi <span class="math inline">k&gt;2</span>, quy ước</p>
<p><span id="eq-k_greater_2"><span class="math display">
Q^{(k)}(\pi)=(Q\ast Q^{(k-1)})(\pi)=\sum_{\pi_{1}\in S_{n}}Q(\pi_{1})Q^{(k-1)}(\pi_{1}^{-1}\circ\pi).
\tag{2}</span></span></p>
<p>Để ý rằng phân phối xác suất <span class="math inline">Q^{(k)}</span> có thể được xác định chỉ dựa vào duy nhất phân phối <span class="math inline">Q^{(k-1)}</span>. Điều này đưa ta đến một ngôn ngữ chính thức hơn, là xích Markov.</p>
</section>
<section id="xích-markov" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="xích-markov"><span class="header-section-number">2.2</span> Xích Markov</h2>
<p>Xét một dãy hữu hạn các biến ngẫu nhiên <span class="math inline">X_{0},X_{1},\ldots,X_{k}</span>, mỗi biến ngẫu nhiên nhận giá trị trên <span class="math inline">S_{n}</span> và <span class="math inline">Q\colon S_{n}\to\left[0,1\right]</span> là phân phối xác suất của các biến ngẫu nhiên <span class="math inline">X_{i}</span>, thoả mãn <span class="math inline">Q(\pi)\ge0</span> với mọi <span class="math inline">\pi\in S_{n}</span> và <span class="math inline">\displaystyle\sum_{\pi\in S_{n}}Q(\pi)=1</span>.</p>
<p>Tương tự như cách ta bắt đầu với bộ bài có trạng thái <span class="math inline">\left(1,2,\ldots,n\right)</span>. Giả sử <span class="math inline">X_{0}</span> luôn nhận giá trị là phần tử đơn vị của nhóm <span class="math inline">\left(S_{n},\circ\right)</span>, tức là <span class="math inline">\mathbb{P}(X_{0}=\varepsilon)=1</span>. Xem xét một số xác suất có điều kiện sau (có thể bỏ qua điều kiện <span class="math inline">X_{0}=\varepsilon</span>)</p>
<span class="math display">\begin{align*}
&amp;\mathbb{P}(X_{1}=\pi_{1}\mid X_{0}=\varepsilon)=Q(\pi_{1}),\\
&amp;\mathbb{P}(X_{2}=\pi_{2}\mid X_{0}=\varepsilon,X_{1}=\pi_{1})=Q^{(2)}(\pi_{k-1}),\\
&amp;\ldots\\
&amp;\mathbb{P}(X_{k}=\pi_{k}\mid X_{0}=\varepsilon,X_{1}=\pi_{1},\ldots,X_{k-1}=\pi_{k-1})=Q^{(k)}(\pi_{k}).
\end{align*}</span>
<p>Kết hợp với (<a href="#eq-k_equal_2" class="quarto-xref">1</a>) và (<a href="#eq-k_greater_2" class="quarto-xref">2</a>), với mỗi <span class="math inline">k\ge2</span>, ta thấy rằng</p>
<p><span id="eq-k_greater_equal_2"><span class="math display">
Q^{(k)}(\pi_{k})=\sum_{\pi\in S_{n}}Q(\pi)Q^{(k-1)}(\pi^{-1}\circ\pi_{k}).
\tag{3}</span></span></p>
<p>Công thức <a href="#eq-k_greater_equal_2" class="quarto-xref">Equation&nbsp;3</a> thể hiện xác suất <span class="math inline">Q^{(k)}</span> chỉ phụ thuộc vào xác suất <span class="math inline">Q^{(k-1)}</span> ngay trước nó. Suy ra, với mọi <span class="math inline">i=1,2,\ldots,k</span> và với mọi <span class="math inline">\pi_{1},\pi_{2},\ldots,\pi_{k}\in S_{n}</span>,</p>
<p><span class="math display">
\mathbb{P}(X_{i}=\pi_{i}\mid X_{0}=\varepsilon,X_{1}=\pi_{1},\ldots,X_{i-1})=\mathbb{P}(X_{i}=\pi_{i}\mid X_{i-1}=\pi_{i-1}).
</span></p>
<p>Như vậy việc xáo trộn (ngẫu nhiên) một bộ bài một số lần có thể được mô hình hoá thành một xích Markov.</p>
</section>
<section id="khoảng-cách-biến-phân" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="khoảng-cách-biến-phân"><span class="header-section-number">2.3</span> Khoảng cách biến phân</h2>
<p>Giả sử ta đã có một bộ bài được xáo trộn theo phương pháp <span class="math inline">Q</span> một số lần. Bây giờ ta cần một phép đo để biết liệu rằng kết quả của phương pháp xáo bài này đang cách sự ngẫu nhiên bao xa. Trước hết, cần thống nhất về sự ngẫu nhiên, rằng kết quả được gọi là ngẫu nhiên nếu như mọi trạng thái của bộ bài đều có khả năng xuất hiện như nhau sau các lần xáo trộn. Để thể hiện điều này, ta gán một phân phối đều <span class="math inline">\mathcal{U}</span> lên <span class="math inline">S_{n}</span>, cụ thể, <span class="math inline">\mathcal{U}(\pi)=\left\vert S_{n}\right\vert^{-1}=\left(n!\right)^{-1}</span>. Khi đó ta có thể đồng nhất xác suất để hoán vị <span class="math inline">\pi</span> xuất hiện và xác suất để bộ bài ở trạng thái <span class="math inline">\left(\pi(1),\pi(2),\ldots,\pi(n)\right)</span>.</p>
<p>Ở đây ta đưa ra một công cụ để đo sự sai khác mà trong trường hợp này là của hai phân phối xác suất. Xét hai phân phối xác suất <span class="math inline">Q_{1}</span> và <span class="math inline">Q_{2}</span> trên <span class="math inline">S_{n}</span>. Khoảng cách biến phân của <span class="math inline">Q_{1}</span> và <span class="math inline">Q_{2}</span> được định nghĩa bởi</p>
<p><span class="math display">
\left\lVert Q_{1}-Q_{2}\right\rVert=\frac{1}{2}\sum_{\pi\in S_{n}}\left\vert Q_{1}(\pi)-Q_{2}(\pi)\right\vert.
</span></p>
<p>Hệ số <span class="math inline">\frac{1}{2}</span> được thêm vào để đảm bảo khoảng cách biến phân nằm trong <span class="math inline">\left[0,1\right]</span>, vì</p>
<p><span class="math display">
\sum_{\pi\in S_{n}}\left\vert Q_{1}(\pi)-Q_{2}(\pi)\right\vert\le\sum_{\pi\in S_{n}}\left\vert Q_{1}(\pi)\right\vert+\sum_{\pi\in S_{n}}\left\vert Q_{2}(\pi)\right\vert\le2.
</span></p>
<p>Ta mong muốn đo được phân phối cuối cùng (sau <span class="math inline">k</span> lần tích chập) của chúng ta cách phân phối đều “bao xa”, và mất “bao lâu” để <span class="math inline">Q^{(k)}</span> đến đủ gần <span class="math inline">\mathcal{U}</span>. Như vậy ta cần tính được khoảng cách biến phân của hai phân phối <span class="math inline">Q^{(k)}</span> và <span class="math inline">\mathcal{U}</span> trên <span class="math inline">S_{n}</span>, chính là</p>
<p><span class="math display">
\left\lVert Q^{(k)}-\mathcal{U}\right\rVert=\frac{1}{2}\sum_{\pi\in S_{n}}\left\vert Q^{(k)}(\pi)-\mathcal{U}(\pi)\right\vert.
</span></p>
</section>
</section>
<section id="phương-pháp-chẻ-bài" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Phương pháp chẻ bài</h1>
<p>Thực tế có nhiều cách xáo trộn một bộ bài. Ở đây ta quan tâm đến một trong những phương pháp thông dụng nhất để làm việc này, đồng thời cũng có thể được mô hình hoá đẹp đẽ bằng toán học, đó là phương pháp chẻ bài.</p>
<section id="phương-pháp-chẻ-bài-thông-thường" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="phương-pháp-chẻ-bài-thông-thường"><span class="header-section-number">3.1</span> Phương pháp chẻ bài thông thường</h2>
<p>Đây là một phương pháp phổ biến để xáo bài. Ở đây ta chỉ cần quan tâm đến thứ tự của các lá bài thay vì các kĩ thuật thực hiện trong thực tế. Phương pháp chẻ bài thông thường có thể được mô tả như sau: Chia bộ bài gồm <span class="math inline">n</span> lá bài thành hai phần. Giả sử phần bên trái có <span class="math inline">l</span> lá bài (<span class="math inline">0\le l\le n</span>), như vậy phần còn lại bên phải có <span class="math inline">n-l</span> lá bài. Sau đó xen kẽ các lá bài của hai phần, theo nghĩa, gộp hai phần lại thành một bộ bài sao cho thứ tự tương đối của các lá bài trong mỗi phần không đổi. Thao tác xen kẽ này mang tính ngẫu nhiên và có biến ngẫu nhiên tương ứng tuân theo phân phối đều, tức là mỗi cách xen kẽ đều có khả năng xảy ra như nhau.</p>
<p>Giả định rằng khả năng để phần bên trái có <span class="math inline">l</span> lá bài tuân theo phân phối nhị thức <span class="math inline">\mathcal{B}(n,2)</span>, xác suất này chính là <span class="math inline">\binom{n}{l}2^{-n}</span>. Mặt khác, số cách chọn <span class="math inline">l</span> vị trí trong <span class="math inline">n</span> vị trí cho các lá bài của phần bên trái là <span class="math inline">\binom{n}{l}</span>, các lá bài còn lại của phần bên phải được thêm vào <span class="math inline">n-l</span> vị trí trống theo thứ tự được quy định trước đó, do đó có đúng một cách xếp phần bên phải vào bộ bài. Như vậy, số cách xen kẽ có thể xảy ra là <span class="math inline">\binom{n}{l}</span>, vì vậy, xác suất của mỗi cách xen kẽ là</p>
<p><span id="eq-R2"><span class="math display">
\binom{n}{l}^{-1}.
\tag{4}</span></span></p>
<p>Tóm lại, xác suất của một cách chia ngẫu nhiên bộ bài thành hai phần, trong đó phần bên trái có <span class="math inline">l</span> lá bài, và tiếp theo là một cách xen kẽ ngẫu nhiên đồng đều hai phần lại với nhau, chính là</p>
<p><span class="math display">
\binom{n}{l}2^{-n}\cdot\binom{n}{l}^{-1}=\frac{1}{2^{n}}.
</span></p>
<p>Xác suất này hoàn toàn không phụ thuộc vào <span class="math inline">l</span>, nghĩa là, các cặp gồm một cách phân chia bộ bài thành hai phần và một cách xen kẽ hai phần lại với nhau đều có cùng một khả năng xảy ra. Hơn nữa ta thấy rằng, mỗi một cặp cắt - xen kẽ như vậy là một sự sắp xếp lại thứ tự của bộ bài một cách ngẫu nhiên, hay nói cách khác, tương ứng với một lần xáo bài. Gọi phương pháp (phân phối) chẻ bài thông thường này là <span class="math inline">\mathcal{R}</span>.</p>
<p>Ta xem xét một cách tiếp cận khác cho quá trình xen kẽ. Giả sử bộ bài được chia thành hai phần. Ở mỗi lượt, một lá bài bị thả xuống từ một phần bài nào đó. Xác suất để lá bị thả ở lượt đó đến từ phần có <span class="math inline">l_{1}</span> lá là <span class="math inline">\frac{l_{1}}{n}</span> và đến từ phần có <span class="math inline">l_{2}</span> lá là <span class="math inline">\frac{l_{2}}{n}</span>. Nghĩa là phần bên nào đang có nhiều bài thì càng có khả năng bị thả xuống. Giả định này có vẻ không mâu thuẫn với cảm giác cầm và thả bài trong thực tế. Việc chứng minh cách xen kẽ này tương đương với phía trên sẽ được đề cập một cách tổng quát ở mục <a href="#sec-a-shuffle" class="quarto-xref">3.2.2</a>.</p>
<p>Ở bước phân chia bộ bài thành hai phần, ta đã xem phân phối của vị trí nhát cắt tuân theo phân phối nhị thức. Giả định này có phần hợp lý. Bởi lẽ người ta có xu hướng ‘’cắt’’ tại vị trí ở gần chính giữa bộ bài hơn là ‘’cắt’’ tại các vị trí ở gần trên hoặc dưới cùng. Mỗi nhát cắt có thể được coi như một biến ngẫu nhiên, các biến ngẫu nhiên này là độc lập và được lấy từ phân phối nhị thức <span class="math inline">\mathcal{B}(n,2)</span>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Hiển thị mã</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats.sampling <span class="im">import</span> DiscreteAliasUrn</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_binomial_distribution(n, p, num_samples):</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    k_values <span class="op">=</span> np.arange(n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    pmf_values <span class="op">=</span> binom.pmf(k_values, n, p)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    sampler <span class="op">=</span> DiscreteAliasUrn(pmf_values)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> sampler.rvs(size<span class="op">=</span>num_samples)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    plt.stem(k_values, pmf_values, linefmt<span class="op">=</span><span class="st">"blue"</span>, markerfmt<span class="op">=</span><span class="st">"bo"</span>, basefmt<span class="op">=</span><span class="st">" "</span>, label<span class="op">=</span><span class="st">"Theoretical PMF"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    plt.hist(samples, bins<span class="op">=</span>np.arange(<span class="op">-</span><span class="fl">0.5</span>, n <span class="op">+</span> <span class="fl">1.5</span>, <span class="dv">1</span>), density<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>             color<span class="op">=</span><span class="st">"lightgreen"</span>, edgecolor<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span><span class="st">"Sampled Data"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Value of l"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Probability B(l; n, p)"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Probability Mass Function and </span><span class="sc">{</span>num_samples<span class="sc">}</span><span class="ss"> Random Samples"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">52</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    num_samples <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    plot_binomial_distribution(n, p, num_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="shuffle_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Ta cũng mong muốn biết được sau <span class="math inline">k</span> lần chẻ bài ngẫu nhiên thì ta cách bao xa so với thời điểm mà mọi trạng thái của bộ bài đều có cùng một khả năng xảy ra, tức là cần tính được khoảng cách biến phân của <span class="math inline">\mathcal{R}^{(k)}</span> và <span class="math inline">\mathcal{U}</span>,</p>
<p><span class="math display">
\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert=\frac{1}{2}\sum_{\pi\in S_{n}}\left\vert\mathcal{R}^{(k)}(\pi)-\mathcal{U}(\pi)\right\vert.
</span></p>
<p>Việc tính toán trực tiếp đại lượng trên là một quá trình nhọc nhằn với con người, và đủ phức tạp kể cả với hầu hết các máy tính nếu <span class="math inline">n</span> đủ lớn (có đến <span class="math inline">n!</span> tổng cần tính toán!).</p>
</section>
<section id="phương-pháp-a-chẻ-bài" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="phương-pháp-a-chẻ-bài"><span class="header-section-number">3.2</span> Phương pháp <span class="math inline">a</span>-chẻ bài</h2>
<section id="dãy-tăng" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="dãy-tăng"><span class="header-section-number">3.2.1</span> Dãy tăng</h3>
<p>Đầu tiên ta định nghĩa một dãy tăng trong một trạng thái của bộ bài (có thể đồng nhất với dãy tăng trong một hoán vị theo nghĩa là trạng thái ngay sau khi thực hiện hoán vị đó cho trạng thái <span class="math inline">\left(1,2,\ldots,n\right)</span>). Giả sử ta có một bộ bài <span class="math inline">n</span> lá đang ở trạng thái <span class="math inline">\left(1,2,\ldots,n\right)</span>. Sau đó thực hiện một hoán vị <span class="math inline">\pi\in S_{n}</span> nào đó chuyển bộ bài sang trạng thái <span class="math inline">\left(\sigma(1),\sigma(2),\ldots,\sigma(n)\right)</span>. Chọn một lá <span class="math inline">x\in\llbracket n\rrbracket</span> bất kì trong bộ bài. Ta thực hiện hai hành động sau đây</p>
<ol type="i">
<li><p>Bắt đầu từ lá bài ngay bên trên <span class="math inline">x</span>, tìm lá <span class="math inline">x+1</span>. Nếu tìm thấy lá <span class="math inline">x+1</span>, bắt đầu từ lá bài ngay bên trên <span class="math inline">x+1</span>, tìm lá <span class="math inline">x+2</span>. Quá trình tìm kiếm dừng lại khi không thể tìm được lá bài thoả mãn.</p></li>
<li><p>Bắt đầu từ lá bài ngay bên dưới <span class="math inline">x</span>, tìm lá <span class="math inline">x-1</span>. Nếu tìm thấy lá <span class="math inline">x-1</span>, bắt đầu từ lá bài ngay bên dưới <span class="math inline">x-1</span>, tìm lá <span class="math inline">x-2</span>. Quá trình tìm kiếm dừng lại khi không thể tìm được lá bài thoả mãn.</p></li>
</ol>
<p>Dĩ nhiên hai quá trình trên sẽ dừng lại sau một số hữu hạn thao tác. Khi đó, ta nhận được chính xác một dãy tăng liên tục <span class="math inline">x-i,x-i+1,\ldots,x,\ldots,x+j-1,x+j</span>. Có thể xem đây là một dãy con của dãy <span class="math inline">1,2,\ldots,n</span>.</p>
<p>Tiếp tục chọn bất kì một lá <span class="math inline">y</span> (nếu có thể) và thực hiện hai hành động tương tự như lá <span class="math inline">x</span>. Kết quả nhận được sau toàn bộ thao tác (chọn và tìm) chính là các dãy con, tăng và liên tục của dãy <span class="math inline">1,2,\ldots,n</span>. Hơn nữa, chúng chính là một phân hoạch của <span class="math inline">1,2,\ldots,n</span>.</p>
</section>
<section id="sec-a-shuffle" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="sec-a-shuffle"><span class="header-section-number">3.2.2</span> <span class="math inline">a</span>-chẻ bài</h3>
<p>Có nhiều mô tả tương đương (theo nghĩa cùng cho ra một phân phối của các hoán vị) cho phương pháp <span class="math inline">a</span>-chẻ bài, một tổng quát hoá của phương pháp chẻ bài thông thường. Ta sẽ xem xét một số hướng tiếp cận phương pháp này.</p>
<p>Với <span class="math inline">a</span> là một số nguyên dương. Chia bộ bài gồm <span class="math inline">n</span> lá bài thành <span class="math inline">a</span> phần, mỗi phần có số lá bài lần lượt là <span class="math inline">l_{1},l_{2},\ldots,l_{a}</span>, trong đó <span class="math inline">l_{i}\ge0</span> với mọi <span class="math inline">i=1,2,\ldots,a</span> và <span class="math inline">l_{1}+l_{2}+\ldots+l_{a}=n</span>. Sau đó xen kẽ các lá bài của <span class="math inline">a</span> phần này với nhau, theo nghĩa, gộp <span class="math inline">a</span> phần lại thành một bộ bài sao cho thứ tự tương đối của các lá bài trong mỗi phần không thay đổi.</p>
<p>Hành động phân chia bộ bài bên trên tuân theo phân phối đa thức (một phiên bản tổng quát của phân phối nhị thức). Nói cách khác, xác suất để các phần có số lá bài lần lượt là <span class="math inline">l_{1},l_{2},\ldots,l_{a}</span>, chính bằng</p>
<p><span class="math display">
\binom{n}{l_{1},l_{2},\ldots,l_{a}}a^{-n}=\frac{n!}{l_{1}!l_{2}!\cdots l_{a}!}a^{-n}.
</span></p>
<p>Ta thực hiện tiếp tục xen kẽ <span class="math inline">a</span> phần này theo cách, mỗi lần, thả một lá bài ở dưới cùng của một phần nào đó (lá bài được thả ở lần ngay sau đó nằm ngay trên lá bài vừa được thả ở lần trước), trong đó khả năng để lá bài được thả xuống ở một lần nào đó đến từ phần <span class="math inline">i</span> là</p>
<p><span id="eq-prop_prob"><span class="math display">
\frac{l_{i}}{l_{1}+l_{2}+\ldots+l_{a}}.
\tag{5}</span></span></p>
<p>Ở mỗi lần, biểu thức (<a href="#eq-prop_prob" class="quarto-xref">5</a>) sẽ được cập nhật dựa trên sự thay đổi của số lá bài hiện có trong mỗi phần. Đơn cử, xét trường hợp các lá bài trong mỗi phần được thả liên tiếp, lần lượt từ phần <span class="math inline">1</span> đến phần <span class="math inline">a</span>. Khi đó xác suất của <span class="math inline">l_{1}</span> lần thả đầu tiên là</p>
<p><span class="math display">
\frac{l_{1}}{n}\cdot\frac{l_{1}-1}{n-1}\cdots\frac{1}{n-l_{1}+1}=\frac{l_{1}\left(l_{1}-1\right)\cdots1}{n\left(n-1\right)\cdots\left(n-l_{1}+1\right)}.
</span></p>
<p>Tương tự, xác suất của <span class="math inline">n-l_{1}</span> lần thả còn lại là</p>
<p><span class="math display">
\prod_{i=2}^{a}\frac{l_{i}\left(l_{i}-1\right)\cdots1}{\left(n-l_{1}-l_{2}-\ldots-l_{i-1}\right)\left(n-l_{1}-l_{2}-\ldots-l_{i-1}-1\right)\cdots\left(n-l_{1}-l_{2}-\ldots-l_{i}+1\right)}.
</span></p>
<p>Nhớ rằng <span class="math inline">l_{1}+l_{2}+\ldots+l_{a}=n</span>. Như vậy xác suất của toàn bộ quá trình thả bài, chính bằng</p>
<p><span id="eq-drop"><span class="math display">
\frac{\left(l_{1}\left(l_{1}-1\right)\cdots1\right)\left(l_{2}\left(l_{2}-1\right)\cdots1\right)\cdots\left(l_{a}\left(l_{a}-1\right)\cdots1\right)}{n\left(n-1\right)\cdots1}=\frac{l_{1}!l_{2}!\cdots l_{a}!}{n!}.
\tag{6}</span></span></p>
<p>Trong trường hợp thứ tự của các lá bài của <span class="math inline">a</span> phần trong các lần thả thay đổi, xác suất cuối cùng vẫn giữ nguyên. Bởi, khi ta thay đổi thứ tự thả xuống của hai lá bài, bản chất chỉ là đang thay đổi thứ tự các nhân tử ở tử số của phân thức (<a href="#eq-drop" class="quarto-xref">6</a>).</p>
<p>Một cách suy diễn tương đương khác để dẫn đến xác suất trên. Đó là sau khi chọn theo phân phối đa thức một cách phân chia bộ bài thành <span class="math inline">a</span> phần, sau đó lấy lần lượt, bất kỳ, hai phần khác nhau và thực hiện xen kẽ hai phần này thành một bộ, tức xem như chẻ bài thông thường cho một bộ bài. Thao tác tương tự cho những cặp khác. Sau <span class="math inline">a-1</span> lần thực hiện chẻ bài thông thường cho mỗi bộ hai phần, ta nhận được bộ bài gồm <span class="math inline">n</span> lá ban đầu. Ta sẽ chứng minh rằng hướng tiếp cận này tương đương với quá trình thả bài phía trên, theo nghĩa, xác suất cuối cùng của hai cách này là như nhau. Thật vậy, giả sử rằng ta chọn các cặp của các phần theo thứ tự: phần <span class="math inline">1</span> và phần <span class="math inline">2</span>, tiếp theo là phần <span class="math inline">1</span>, <span class="math inline">2</span> và phần <span class="math inline">3</span>, sau đó là phần <span class="math inline">1</span>, <span class="math inline">2</span>, <span class="math inline">3</span> và phần <span class="math inline">4</span>,… Tương tự cho đến cặp cuối cùng. Sử dụng công thức xác suất (<a href="#eq-R2" class="quarto-xref">4</a>), ta nhận được xác suất của toàn bộ <span class="math inline">a-1</span> lần thực hiện chẻ bài thông thường là</p>
<span class="math display">\begin{align*}
&amp;\binom{l_{1}+l_{2}}{l_{2}}^{-1}\binom{l_{1}+l_{2}+l_{3}}{l_{3}}^{-1}\cdots\binom{l_{1}+l_{2}+\ldots+l_{a}}{l_{a}}^{-1}\\
=&amp;\left(\frac{\left(l_{1}+l_{2}\right)!}{l_{1}!l_{2}!}\cdot\frac{\left(l_{1}+l_{2}+l_{3}\right)!}{\left(l_{1}+l_{2}\right)!l_{3}!}\cdots\frac{\left(l_{1}+l_{2}+\ldots+l_{a}\right)!}{\left(l_{1}+l_{2}+\ldots+l_{a-1}\right)!l_{a}!}\right)^{-1}\\
=&amp;\left(\frac{\left(l_{1}+l_{2}+\ldots+l_{a}\right)!}{l_{1}!l_{2}!\cdots l_{a}!}\right)^{-1}\\
=&amp;\frac{l_{1}!l_{2}!\cdots l_{a}!}{n!}.
\end{align*}</span>
<p>Như vậy hai cách tiếp cận trên là tương đương. Cuối cùng, xác suất để chọn được một cách phân chia và xen kẽ thoả mãn các điều kiện phía trên, chính là</p>
<p><span id="eq-a_uni"><span class="math display">
\binom{n}{l_{1},l_{2},\ldots,l_{a}}a^{-n}\cdot\frac{l_{1}!l_{2}!\cdots l_{a}!}{n!}=\frac{1}{a^{n}}.
\tag{7}</span></span></p>
<p>Như vậy, mỗi cặp phân chia - xen kẽ ở phương pháp <span class="math inline">a</span>-chẻ bài cũng tuân theo phân phối đều và bản chất cũng là một lần xáo bài. Ta gọi phương pháp <span class="math inline">a</span>-chẻ bài này là <span class="math inline">\mathcal{R}_{a}</span>, với phân phối xác suất <span class="math inline">\mathcal{R}_{a}</span> tương ứng. Dễ thấy <span class="math inline">\mathcal{R}_{2}=\mathcal{R}</span>, nói cách khác phương pháp chẻ bài thông thường chính là phương pháp <span class="math inline">2</span>-chẻ bài.</p>
</section>
<section id="định-lý-nhân-và-định-lý-dãy-tăng" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="định-lý-nhân-và-định-lý-dãy-tăng"><span class="header-section-number">3.2.3</span> Định lý nhân và định lý dãy tăng</h3>
<div class="theorem" style="border-left: 4px solid #019af1; padding-left: 10px;">
<p><span style="color:#019af1; font-weight:bold;">Định lý 1</span></p>
<p>Với <span class="math inline">a,b</span> là các số tự nhiên, thực hiện một lần <span class="math inline">a</span>-chẻ bài và sau đó là một lần <span class="math inline">b</span>-chẻ bài tương đương với việc thực hiện một lần <span class="math inline">ab</span>-chẻ bài. Cụ thể, giả sử <span class="math inline">\mathcal{R}_{a}</span>, <span class="math inline">\mathcal{R}_{b}</span>, <span class="math inline">\mathcal{R}_{ab}</span> lần lượt là phân phối của <span class="math inline">a</span>-chẻ bài, <span class="math inline">b</span>-chẻ bài, <span class="math inline">ab</span>-chẻ bài. Khi đó <span class="math inline">\mathcal{R}_{a}\ast\mathcal{R}_{b}=\mathcal{R}_{ab}</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Xem xét một mô tả tương đương sau của phương pháp <span class="math inline">a</span>-chẻ bài. Phương pháp này có thể được mô tả một cách hình học như việc thả độc lập, ngẫu nhiên theo phân phối đều <span class="math inline">n</span> điểm vào đoạn thẳng đơn vị <span class="math inline">\left[0,1\right]</span>, sau đó tác động ánh xạ <span class="math inline">x\mapsto ax\pmod1</span>, đi từ <span class="math inline">\left[0,1\right]</span> vào chính nó. Ánh xạ này hoán vị <span class="math inline">n</span> điểm ban đầu và bảo toàn độ đo trên <span class="math inline">\left(S_{n},\circ\right)</span>. Số lượng điểm rơi vào các đoạn <span class="math inline">\left[0,\frac{1}{a}\right]</span>, <span class="math inline">\left[\frac{1}{a},\frac{2}{a}\right]</span>, …, <span class="math inline">\left[\frac{a-1}{a},1\right]</span> tuân theo phân phối đa thức. Định lý được chứng minh nhờ tính chất sau</p>
<p><span class="math display">
b\left(ax\!\pmod1\right)\!\pmod1=abx\!\pmod1.
</span></p>
</div>
<p>Vì một lần chẻ bài thông thường là một lần <span class="math inline">2</span>-chẻ bài, do đó thay vì cố gắng xác định chính xác tích chập <span class="math inline">\mathcal{R}^{(k)}</span> của <span class="math inline">k</span> lần phân phối <span class="math inline">\mathcal{R}</span>, ta chỉ cần tính toán cho một lần <span class="math inline">2^{k}</span>-chẻ bài duy nhất, ứng với phân phối <span class="math inline">\mathcal{R}_{2^{k}}</span>.</p>
<div class="theorem" style="border-left: 4px solid #019af1; padding-left: 10px;">
<p><span style="color:#019af1; font-weight:bold;">Định lý 2</span></p>
<p>Xác suất nhận được hoán vị <span class="math inline">\pi\in S_{n}</span> khi thực hiện một lần <span class="math inline">a</span>-chẻ bài là</p>
<p><span class="math display">
\frac{1}{a^{n}}\binom{a+n-r_{\pi}}{n},
</span> với <span class="math inline">r_{\pi}</span> là số dãy tăng trong <span class="math inline">\pi</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Giả sử ta nhận được hoán vị <span class="math inline">\pi</span> sau một lần <span class="math inline">a</span>-chẻ bài, tức là sau một lần phân chia và một lần xen kẽ nào đó. Xét một cách phân chia trong số đó, lúc này chỉ có duy nhất một cách để cách xen kẽ <span class="math inline">a</span> phần này lại với nhau (vì với bất kì cách chia nào của bộ bài, ta chỉ cần thả các lá bài ở <span class="math inline">a</span> phần theo thứ tự của hoán vị <span class="math inline">\pi</span>). Ta đếm số cách phân chia bộ bài thành <span class="math inline">a</span> phần mà sau đó có thể xen kẽ lại với nhau và nhận được hoán vị <span class="math inline">\pi</span>. Nếu có <span class="math inline">r_{\pi}</span> dãy tăng trong <span class="math inline">\pi</span>, ta biết được chắc chắn <span class="math inline">r_{\pi}-1</span> trong số <span class="math inline">a-1</span> nhát cắt để đảm bảo nhận được hoán vị <span class="math inline">\pi</span> sau khi xen kẽ. Ta chọn vị trí của <span class="math inline">a-1-\left(r_{\pi}-1\right)=a-r_{\pi}</span> nhát cắt còn lại giữa bộ bài <span class="math inline">n</span> lá, dễ thấy có <span class="math inline">\binom{n+a-r_{\pi}}{a-r_{\pi}}</span> lựa chọn như vậy (bài toán chia kẹo Euler). Từ (<a href="#eq-a_uni" class="quarto-xref">7</a>) ta thấy xác suất xảy ra của mỗi hoán vị là <span class="math inline">a^{-n}</span>. Vậy xác suất để nhận được hoán vị <span class="math inline">\pi</span>, có <span class="math inline">r_{\pi}</span> dãy tăng, sau khi thực hiện một lần <span class="math inline">a</span>-chẻ bài là</p>
<p><span class="math display">
\binom{n+a-r_{\pi}}{a-r_{\pi}}\cdot a^{-n}=\frac{1}{a^{n}}\binom{a+n-r_{\pi}}{n}.
</span></p>
</div>
<p>Một lợi thế khác khi ta quan tâm đến các <span class="math inline">a</span>-chẻ bài là sau khi thực hiện một lần <span class="math inline">a</span>-chẻ bài, khả năng xuất hiện của hoán vị <span class="math inline">\pi\in S_{n}</span> có thể được tính toán chỉ với duy nhất thông tin về số dãy tăng <span class="math inline">r_{\pi}</span> trong <span class="math inline">\pi</span>.</p>
</section>
</section>
</section>
<section id="cần-ít-nhất-bao-nhiêu-lần-xáo-bài" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Cần ít nhất bao nhiêu lần xáo bài?</h1>
<p>Hai định lý quan trọng trên cho ta một công thức để tính phân phối của <span class="math inline">k</span> lần chẻ bài thông thường, hay một lần <span class="math inline">2^{k}</span>-chẻ bài. Cụ thể, với mỗi hoán vị <span class="math inline">\pi\in S_{n}</span>, ta có</p>
<p><span class="math display">
\mathcal{R}^{(k)}(\pi)=\mathcal{R}_{2^{k}}(\pi)=\frac{1}{2^{nk}}\binom{2^{k}+n-r_{\pi}}{n}.
</span></p>
<p>Do đó,</p>
<p><span class="math display">
\left\vert\mathcal{R}^{(k)}(\pi)-\mathcal{U}(\pi)\right\vert=\left\vert\frac{1}{2^{nk}}\binom{2^{k}+n-r_{\pi}}{n}-\frac{1}{n!}\right\vert.
</span></p>
<p>Dựa vào định lý dãy tăng, ta chỉ cần nhóm các hoán vị có cùng số dãy tăng và tính toán số các hoán vị trong mỗi nhóm. Gọi <span class="math inline">\!\left\langle n\atop r\right\rangle\!</span> là số hoán vị của tập <span class="math inline">\llbracket n\rrbracket</span> có <span class="math inline">r</span> dãy tăng. Như vậy khoảng cách biến phân của <span class="math inline">\mathcal{R}^{(k)}</span> và <span class="math inline">\mathcal{U}</span> có thể được viết lại thành</p>
<p><span class="math display">
\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert=\frac{1}{2}\sum_{r=1}^{n}\!\left\langle n\atop r\right\rangle\!\left\vert\frac{1}{2^{nk}}\binom{2^{k}+n-r}{n}-\frac{1}{n!}\right\vert.
</span></p>
<p>Các số <span class="math inline">\!\left\langle n\atop r\right\rangle\!</span> được gọi là các số Euler. Có thể được xác định qua công thức truy hồi sau, với mỗi <span class="math inline">n</span> cố định, và <span class="math inline">\!\left\langle n\atop1\right\rangle\!=1</span> thì</p>
<p><span class="math display">
\!\left\langle n\atop r\right\rangle\!=r^{n}-\sum_{j=1}^{r-1}\binom{n+r-j}{n}\!\left\langle n\atop j\right\rangle\!,
</span></p>
<p>với mọi <span class="math inline">r\ge2</span>.</p>
<p>Với <span class="math inline">n=52</span>, khoảng cách biến phân được trực quan hoá qua đồ thị sau</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Hiển thị mã</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmp)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">&lt;-</span> <span class="cf">function</span>(k){</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">52</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">=</span> t <span class="sc">+</span> (<span class="fu">Eulerian</span>(<span class="dv">52</span>,r<span class="dv">-1</span>,<span class="at">method=</span><span class="fu">c</span>(<span class="st">"lookup.or.store"</span>,<span class="st">"direct"</span>)))<span class="sc">*</span>(<span class="fu">as.bigq</span>((((<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">abs</span>(((<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>(n<span class="sc">*</span>k)))<span class="sc">*</span>(<span class="fu">choose</span>((<span class="dv">2</span><span class="sc">^</span>k)<span class="sc">+</span>n<span class="sc">-</span>r,n))) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">factorial</span>(n)))))))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.double</span>(t))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_values, dis)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Số lần chẻ bài"</span>, <span class="at">y =</span> <span class="st">"Khoảng cách biến phân"</span>) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#1c1c1d"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f1efe3"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"cyan"</span>),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"cyan"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span> </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">12</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="shuffle_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ta nhận thấy rằng, với <span class="math inline">k\le5</span> thì <span class="math inline">\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert&gt;0.9</span>. Sau đó giảm rất nhanh, khi <span class="math inline">k=6</span> là <span class="math inline">0.6135496</span>, khi <span class="math inline">k=7</span> là <span class="math inline">0.334061</span>, khi <span class="math inline">k=8</span> là <span class="math inline">0.1671586</span>, và với <span class="math inline">k\ge9</span>, ta có <span class="math inline">\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert&lt;0.1</span>. Do vậy, chẻ bài <span class="math inline">7</span> lần có lẽ là một lựa chọn hợp lý, và có cơ sở toán học.</p>


<!-- -->


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-petersen2015eulerian" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">T.K. Petersen, T.K. Petersen, Eulerian numbers, Springer, 2015.</div>
</div>
<div id="ref-mann1994many" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">B. Mann, How many times should you shuffle a deck of cards, UMAP J 15 (1994) 303–332.</div>
</div>
<div id="ref-levin2017markov" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">D.A. Levin, Y. Peres, Markov chains and mixing times, American Mathematical Soc., 2017.</div>
</div>
<div id="ref-grinstead2012introduction" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">C.M. Grinstead, J.L. Snell, Introduction to probability, American Mathematical Soc., 2012.</div>
</div>
<div id="ref-bayer1992trailing" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">D. Bayer, P. Diaconis, Trailing the dovetail shuffle to its lair, The Annals of Applied Probability (1992) 294–313.</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb3" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Cần bao nhiêu lần xáo cho một bộ bài?"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> "Bài viết này cung cấp một cái nhìn toán học đằng sau việc xáo trộn một bộ bài. Hơn nữa là đưa ra một cơ sở để trả lời cho câu hỏi: ''Một bộ bài cần xáo trộn bao nhiêu lần để được coi là ngẫu nhiên?''."</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Phùng Minh Quân"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-02-01"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> MMM D, YYYY</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified-format:</span><span class="co"> MMM D, YYYY</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Probability]</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "cards.jpg"</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Mục lục"</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method: katex</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">    css: ../../assets/styles.css</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Hiển thị mã"</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> shuffle.bib</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> elsevier-with-titles.csl</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="an">nocite:</span><span class="co"> |</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">  @*</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tips</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>Một bộ bài đi kèm có thể giúp trải nghiệm tốt hơn.</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hoán vị và sự sắp xếp lại</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>Trước tiên ta cần định nghĩa một số khái niệm. Với mỗi $n\in\mathbb{N}^{*}$, kí hiệu $\llbracket n\rrbracket$ là tập tất cả các số tự nhiên từ $1$ đến $n$.</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>**Định nghĩa 1.** Với mỗi $n\in\mathbb{N}^{*}$, một hoán vị $\sigma$ là một song ánh $\sigma\colon\llbracket n\rrbracket\to\llbracket n\rrbracket$.</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>Kí hiệu tập tất cả các hoán vị (trên tập $\llbracket n\rrbracket$) là $S_{n}$. Dễ thấy rằng $\left\vert S_{n}\right\vert=n!$. Hơn nữa, hoán vị $\sigma\colon\llbracket n\rrbracket\to\llbracket n\rrbracket$ có thể được viết dưới dạng</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>\sigma=</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>1 &amp; 2 &amp; 3 &amp; \ldots &amp; n<span class="sc">\\</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>\sigma(1) &amp; \sigma(2) &amp; \sigma(3) &amp; \ldots &amp; \sigma(n).</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>Hoặc chỉ gồm dòng thứ hai $\sigma=\left(\sigma(1),\sigma(2),\ldots,\sigma(n)\right)$, trong đó hiểu rằng dòng đầu tiên được viết theo thứ tự tăng dần từ $1$ đến $n$.</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>Bây giờ ta có một bộ bài gồm $n$ lá bài, mỗi lá được gán nhãn lần lượt từ $1$ đến $n$. Một trạng thái của bộ bài là một bộ có thứ tự các lá bài $\left(x_{1},x_{2},\ldots,x_{n}\right)$, trong đó $x_{i}\in\llbracket n\rrbracket$ và các lá bài trong bộ bài cũng theo thứ tự đó từ dưới lên trên. Việc sắp xếp lại thứ tự của $n$ lá bài này chỉ là sự thay đổi thứ tự các phần tử của $\llbracket n\rrbracket$ thành một thứ tự khác, nói cách khác, chính là một hoán vị.</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>Như vậy ta biết rằng một hoán vị sẽ tương ứng với một sự sắp xếp lại bộ bài nào đó (về sau ta gọi vắn tắt một lần sắp xếp lại thứ tự bộ bài tương ứng với hoán vị $\sigma$ là sắp theo $\sigma$). Giả sử có hai lần sắp theo $\pi$ và $\tau$. Ta sẽ chỉ ra rằng khi thực hiện lần lượt lần sắp theo $\pi$, và tiếp sau đó là sắp theo $\tau$, thì kết quả sẽ là một sự sắp theo $\pi\circ\tau$. Thực vậy, với mỗi $i,j\in\llbracket n\rrbracket$, sắp theo $\pi$ làm lá bài đang ở vị trí thứ $\pi(i)$ chuyển sang vị trí thứ $i$, tiếp sau đó là sắp theo $\tau$ làm lá bài đang ở vị trí thứ $\tau(j)$ chuyển sang vị trí thứ $j$. Cho $i=\tau(j)$, sau hai lần sắp xếp, lá bài ban đầu ở vị trí thứ $\pi(i)=\pi(\tau(j))$ chuyển sang vị trí thứ $j$, hay chính là một lần sắp theo $\pi\circ\tau$.</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>Ta biết rằng tập $S_{n}$ các hoán vị cùng với phép toán hợp thành $\circ$ lập thành một nhóm. Nhóm $\left(S_{n},\circ\right)$ không giao hoán với $n\ge3$. Do đó, nói chung, kết quả của việc thực hiện liên tiếp hai lần sắp xếp là khác nhau nếu ta thay đổi thứ tự của các lần sắp xếp.</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>Cần lưu ý mỗi hoán vị thể hiện cách một bộ bài thay đổi từ trạng thái này sang trạng thái khác. Chúng không thể hiện trực tiếp trạng thái trước hoặc sau khi sắp xếp của bộ bài (một trường hợp đặc biệt khi bộ bài đang ở trạng thái $\left(1,2,\ldots,n\right)$, lúc này trạng thái của bộ bài ngay sau khi được sắp xếp lại theo hoán vị $\sigma$ là $\left(\sigma(1),\sigma(2),\ldots,\sigma(n)\right)$).</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="fu"># Xáo bài</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>Tiếp theo, ta bổ sung yếu tố ''ngẫu nhiên'' vào quá trình sắp xếp lại bộ bài. Ta có thể xem việc xáo bài (về trực giác, là một thao tác sắp xếp lại bộ bài một cách ngẫu nhiên) như một phân phối xác suất cho tương ứng mỗi cách sắp xếp lại bộ bài với xác suất (khả năng xuất hiện) của nó.</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## Phân phối của các hoán vị</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>Cụ thể, giả sử bộ bài ban đầu đang ở trạng thái $\left(1,2,\ldots,n\right)$, ta áp dụng phương pháp xáo bài $Q$ một số lần cho bộ bài (nghĩa là, sau khi xáo theo phương pháp $Q$, mỗi hoán vị $\pi\in S_{n}$ có xác suất $Q(\pi)$ để lần sắp xếp đó là sắp xếp theo $\pi$). Bắt đầu bằng việc sắp xếp theo hoán vị $\varepsilon$ (phần tử đơn vị của nhóm $\left(S_{n},\circ\right)$), hành động này không làm thay đổi bộ bài so với trạng thái ban đầu. Tiếp theo, chọn ngẫu nhiên một hoán vị $\pi_{1}$ với xác suất để $\pi_{1}$ được chọn là $Q(\pi_{1})$ và sắp xếp lại bộ bài theo $\pi_{1}$. Tiếp tục, hoán vị $\pi_{2}$ được chọn ngẫu nhiên với xác suất $Q(\pi_{2})$ và sắp xếp lại bộ bài theo $\pi_{2}$.</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>Bây giờ, ta xác định phân phối $Q^{(2)}$ của $\pi_{1}\circ\pi_{2}$. Vẫn giả sử rằng các thao tác chọn ngẫu nhiên là độc lập và các hoán vị đều được lấy từ cùng một phân phối $Q$. Như vậy, xác suất để chọn ngẫu nhiên được hoán vị $\pi_{1}$ và sau đó chọn ngẫu nhiên được hoán vị $\pi_{2}$ là $Q(\pi_{1})Q(\pi_{2})$. Do đó ta nhận được phân phối xác suất của $\pi_{1}\circ\pi_{2}$,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>Q^{(2)}(\pi)=\sum_{\pi_{1}\circ\pi_{2}=\pi}Q(\pi_{1})Q(\pi_{2}).</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>Biểu diễn $\pi_{2}=\pi_{1}^{-1}\circ\pi$, trong đó $\pi_{1}^{-1}$ là nghịch đảo của $\pi_{1}$ trong $\left(S_{n},\circ\right)$. Khi đó ta có thể viết biểu thức trên dưới dạng tích chập như sau</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>Q^{(2)}(\pi)=(Q\ast Q)(\pi)=\sum_{\pi_{1}\in S_{n}}Q(\pi_{1})Q(\pi_{1}^{-1}\circ\pi).</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>$$ {#eq-k_equal_2}</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>Với mỗi $k&gt;2$, quy ước</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>Q^{(k)}(\pi)=(Q\ast Q^{(k-1)})(\pi)=\sum_{\pi_{1}\in S_{n}}Q(\pi_{1})Q^{(k-1)}(\pi_{1}^{-1}\circ\pi).</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>$$ {#eq-k_greater_2}</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>Để ý rằng phân phối xác suất $Q^{(k)}$ có thể được xác định chỉ dựa vào duy nhất phân phối $Q^{(k-1)}$. Điều này đưa ta đến một ngôn ngữ chính thức hơn, là xích Markov.</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## Xích Markov</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>Xét một dãy hữu hạn các biến ngẫu nhiên $X_{0},X_{1},\ldots,X_{k}$, mỗi biến ngẫu nhiên nhận giá trị trên $S_{n}$ và $Q\colon S_{n}\to\left<span class="co">[</span><span class="ot">0,1\right</span><span class="co">]</span>$ là phân phối xác suất của các biến ngẫu nhiên $X_{i}$, thoả mãn $Q(\pi)\ge0$ với mọi $\pi\in S_{n}$ và $\displaystyle\sum_{\pi\in S_{n}}Q(\pi)=1$.</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>Tương tự như cách ta bắt đầu với bộ bài có trạng thái $\left(1,2,\ldots,n\right)$. Giả sử $X_{0}$ luôn nhận giá trị là phần tử đơn vị của nhóm $\left(S_{n},\circ\right)$, tức là $\mathbb{P}(X_{0}=\varepsilon)=1$. Xem xét một số xác suất có điều kiện sau (có thể bỏ qua điều kiện $X_{0}=\varepsilon$)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{=tex}</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{align*}</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="in">&amp;\mathbb{P}(X_{1}=\pi_{1}\mid X_{0}=\varepsilon)=Q(\pi_{1}),\\</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="in">&amp;\mathbb{P}(X_{2}=\pi_{2}\mid X_{0}=\varepsilon,X_{1}=\pi_{1})=Q^{(2)}(\pi_{k-1}),\\</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="in">&amp;\ldots\\</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="in">&amp;\mathbb{P}(X_{k}=\pi_{k}\mid X_{0}=\varepsilon,X_{1}=\pi_{1},\ldots,X_{k-1}=\pi_{k-1})=Q^{(k)}(\pi_{k}).</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="in">\end{align*}</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>Kết hợp với (<span class="co">[</span><span class="ot">-@eq-k_equal_2</span><span class="co">]</span>) và (<span class="co">[</span><span class="ot">-@eq-k_greater_2</span><span class="co">]</span>), với mỗi $k\ge2$, ta thấy rằng</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>Q^{(k)}(\pi_{k})=\sum_{\pi\in S_{n}}Q(\pi)Q^{(k-1)}(\pi^{-1}\circ\pi_{k}).</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>$$ {#eq-k_greater_equal_2}</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>Công thức @eq-k_greater_equal_2 thể hiện xác suất $Q^{(k)}$ chỉ phụ thuộc vào xác suất $Q^{(k-1)}$ ngay trước nó. Suy ra, với mọi $i=1,2,\ldots,k$ và với mọi $\pi_{1},\pi_{2},\ldots,\pi_{k}\in S_{n}$,</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>\mathbb{P}(X_{i}=\pi_{i}\mid X_{0}=\varepsilon,X_{1}=\pi_{1},\ldots,X_{i-1})=\mathbb{P}(X_{i}=\pi_{i}\mid X_{i-1}=\pi_{i-1}).</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>Như vậy việc xáo trộn (ngẫu nhiên) một bộ bài một số lần có thể được mô hình hoá thành một xích Markov.</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Khoảng cách biến phân</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>Giả sử ta đã có một bộ bài được xáo trộn theo phương pháp $Q$ một số lần. Bây giờ ta cần một phép đo để biết liệu rằng kết quả của phương pháp xáo bài này đang cách sự ngẫu nhiên bao xa. Trước hết, cần thống nhất về sự ngẫu nhiên, rằng kết quả được gọi là ngẫu nhiên nếu như mọi trạng thái của bộ bài đều có khả năng xuất hiện như nhau sau các lần xáo trộn. Để thể hiện điều này, ta gán một phân phối đều $\mathcal{U}$ lên $S_{n}$, cụ thể, $\mathcal{U}(\pi)=\left\vert S_{n}\right\vert^{-1}=\left(n!\right)^{-1}$. Khi đó ta có thể đồng nhất xác suất để hoán vị $\pi$ xuất hiện và xác suất để bộ bài ở trạng thái $\left(\pi(1),\pi(2),\ldots,\pi(n)\right)$.</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>Ở đây ta đưa ra một công cụ để đo sự sai khác mà trong trường hợp này là của hai phân phối xác suất. Xét hai phân phối xác suất $Q_{1}$ và $Q_{2}$ trên $S_{n}$. Khoảng cách biến phân của $Q_{1}$ và $Q_{2}$ được định nghĩa bởi</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>\left\lVert Q_{1}-Q_{2}\right\rVert=\frac{1}{2}\sum_{\pi\in S_{n}}\left\vert Q_{1}(\pi)-Q_{2}(\pi)\right\vert.</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>Hệ số $\frac{1}{2}$ được thêm vào để đảm bảo khoảng cách biến phân nằm trong $\left<span class="co">[</span><span class="ot">0,1\right</span><span class="co">]</span>$, vì</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>\sum_{\pi\in S_{n}}\left\vert Q_{1}(\pi)-Q_{2}(\pi)\right\vert\le\sum_{\pi\in S_{n}}\left\vert Q_{1}(\pi)\right\vert+\sum_{\pi\in S_{n}}\left\vert Q_{2}(\pi)\right\vert\le2.</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>Ta mong muốn đo được phân phối cuối cùng (sau $k$ lần tích chập) của chúng ta cách phân phối đều "bao xa", và mất "bao lâu" để $Q^{(k)}$ đến đủ gần $\mathcal{U}$. Như vậy ta cần tính được khoảng cách biến phân của hai phân phối $Q^{(k)}$ và $\mathcal{U}$ trên $S_{n}$, chính là</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>\left\lVert Q^{(k)}-\mathcal{U}\right\rVert=\frac{1}{2}\sum_{\pi\in S_{n}}\left\vert Q^{(k)}(\pi)-\mathcal{U}(\pi)\right\vert.</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a><span class="fu"># Phương pháp chẻ bài</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>Thực tế có nhiều cách xáo trộn một bộ bài. Ở đây ta quan tâm đến một trong những phương pháp thông dụng nhất để làm việc này, đồng thời cũng có thể được mô hình hoá đẹp đẽ bằng toán học, đó là phương pháp chẻ bài.</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Phương pháp chẻ bài thông thường</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>Đây là một phương pháp phổ biến để xáo bài. Ở đây ta chỉ cần quan tâm đến thứ tự của các lá bài thay vì các kĩ thuật thực hiện trong thực tế. Phương pháp chẻ bài thông thường có thể được mô tả như sau: Chia bộ bài gồm $n$ lá bài thành hai phần. Giả sử phần bên trái có $l$ lá bài ($0\le l\le n$), như vậy phần còn lại bên phải có $n-l$ lá bài. Sau đó xen kẽ các lá bài của hai phần, theo nghĩa, gộp hai phần lại thành một bộ bài sao cho thứ tự tương đối của các lá bài trong mỗi phần không đổi. Thao tác xen kẽ này mang tính ngẫu nhiên và có biến ngẫu nhiên tương ứng tuân theo phân phối đều, tức là mỗi cách xen kẽ đều có khả năng xảy ra như nhau.</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>Giả định rằng khả năng để phần bên trái có $l$ lá bài tuân theo phân phối nhị thức $\mathcal{B}(n,2)$, xác suất này chính là $\binom{n}{l}2^{-n}$. Mặt khác, số cách chọn $l$ vị trí trong $n$ vị trí cho các lá bài của phần bên trái là $\binom{n}{l}$, các lá bài còn lại của phần bên phải được thêm vào $n-l$ vị trí trống theo thứ tự được quy định trước đó, do đó có đúng một cách xếp phần bên phải vào bộ bài. Như vậy, số cách xen kẽ có thể xảy ra là $\binom{n}{l}$, vì vậy, xác suất của mỗi cách xen kẽ là</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>\binom{n}{l}^{-1}.</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>$$ {#eq-R2}</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>Tóm lại, xác suất của một cách chia ngẫu nhiên bộ bài thành hai phần, trong đó phần bên trái có $l$ lá bài, và tiếp theo là một cách xen kẽ ngẫu nhiên đồng đều hai phần lại với nhau, chính là</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>\binom{n}{l}2^{-n}\cdot\binom{n}{l}^{-1}=\frac{1}{2^{n}}.</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>Xác suất này hoàn toàn không phụ thuộc vào $l$, nghĩa là, các cặp gồm một cách phân chia bộ bài thành hai phần và một cách xen kẽ hai phần lại với nhau đều có cùng một khả năng xảy ra. Hơn nữa ta thấy rằng, mỗi một cặp cắt - xen kẽ như vậy là một sự sắp xếp lại thứ tự của bộ bài một cách ngẫu nhiên, hay nói cách khác, tương ứng với một lần xáo bài. Gọi phương pháp (phân phối) chẻ bài thông thường này là $\mathcal{R}$.</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>Ta xem xét một cách tiếp cận khác cho quá trình xen kẽ. Giả sử bộ bài được chia thành hai phần. Ở mỗi lượt, một lá bài bị thả xuống từ một phần bài nào đó. Xác suất để lá bị thả ở lượt đó đến từ phần có $l_{1}$ lá là $\frac{l_{1}}{n}$ và đến từ phần có $l_{2}$ lá là $\frac{l_{2}}{n}$. Nghĩa là phần bên nào đang có nhiều bài thì càng có khả năng bị thả xuống. Giả định này có vẻ không mâu thuẫn với cảm giác cầm và thả bài trong thực tế. Việc chứng minh cách xen kẽ này tương đương với phía trên sẽ được đề cập một cách tổng quát ở mục <span class="co">[</span><span class="ot">-@sec-a-shuffle</span><span class="co">]</span>.</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>Ở bước phân chia bộ bài thành hai phần, ta đã xem phân phối của vị trí nhát cắt tuân theo phân phối nhị thức. Giả định này có phần hợp lý. Bởi lẽ người ta có xu hướng ''cắt'' tại vị trí ở gần chính giữa bộ bài hơn là ''cắt'' tại các vị trí ở gần trên hoặc dưới cùng. Mỗi nhát cắt có thể được coi như một biến ngẫu nhiên, các biến ngẫu nhiên này là độc lập và được lấy từ phân phối nhị thức $\mathcal{B}(n,2)$.</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{python, fig.align='center'}</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a><span class="in">import numpy as np</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="in">import matplotlib.pyplot as plt</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="in">from scipy.stats import binom</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="in">from scipy.stats.sampling import DiscreteAliasUrn</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="in">def plot_binomial_distribution(n, p, num_samples):</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a><span class="in">    k_values = np.arange(n + 1)</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a><span class="in">    pmf_values = binom.pmf(k_values, n, p)</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a><span class="in">    sampler = DiscreteAliasUrn(pmf_values)</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a><span class="in">    samples = sampler.rvs(size=num_samples)</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.figure(figsize=(10, 5))</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.stem(k_values, pmf_values, linefmt="blue", markerfmt="bo", basefmt=" ", label="Theoretical PMF")</span></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.hist(samples, bins=np.arange(-0.5, n + 1.5, 1), density=True,</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a><span class="in">             color="lightgreen", edgecolor='green', alpha=0.6, label="Sampled Data")</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.xlabel("Value of l")</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.ylabel("Probability B(l; n, p)")</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.title(f"Probability Mass Function and {num_samples} Random Samples")</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.legend()</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="in">    plt.show()</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a><span class="in">if __name__ == "__main__":</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a><span class="in">    n = 52</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="in">    p = 0.5</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a><span class="in">    num_samples = 3000</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a><span class="in">    plot_binomial_distribution(n, p, num_samples)</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>Ta cũng mong muốn biết được sau $k$ lần chẻ bài ngẫu nhiên thì ta cách bao xa so với thời điểm mà mọi trạng thái của bộ bài đều có cùng một khả năng xảy ra, tức là cần tính được khoảng cách biến phân của $\mathcal{R}^{(k)}$ và $\mathcal{U}$,</span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert=\frac{1}{2}\sum_{\pi\in S_{n}}\left\vert\mathcal{R}^{(k)}(\pi)-\mathcal{U}(\pi)\right\vert.</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>Việc tính toán trực tiếp đại lượng trên là một quá trình nhọc nhằn với con người, và đủ phức tạp kể cả với hầu hết các máy tính nếu $n$ đủ lớn (có đến $n!$ tổng cần tính toán!).</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Phương pháp $a$-chẻ bài</span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dãy tăng</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>Đầu tiên ta định nghĩa một dãy tăng trong một trạng thái của bộ bài (có thể đồng nhất với dãy tăng trong một hoán vị theo nghĩa là trạng thái ngay sau khi thực hiện hoán vị đó cho trạng thái $\left(1,2,\ldots,n\right)$). Giả sử ta có một bộ bài $n$ lá đang ở trạng thái $\left(1,2,\ldots,n\right)$. Sau đó thực hiện một hoán vị $\pi\in S_{n}$ nào đó chuyển bộ bài sang trạng thái $\left(\sigma(1),\sigma(2),\ldots,\sigma(n)\right)$. Chọn một lá $x\in\llbracket n\rrbracket$ bất kì trong bộ bài. Ta thực hiện hai hành động sau đây</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>i)  Bắt đầu từ lá bài ngay bên trên $x$, tìm lá $x+1$. Nếu tìm thấy lá $x+1$, bắt đầu từ lá bài ngay bên trên $x+1$, tìm lá $x+2$. Quá trình tìm kiếm dừng lại khi không thể tìm được lá bài thoả mãn.</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>ii) Bắt đầu từ lá bài ngay bên dưới $x$, tìm lá $x-1$. Nếu tìm thấy lá $x-1$, bắt đầu từ lá bài ngay bên dưới $x-1$, tìm lá $x-2$. Quá trình tìm kiếm dừng lại khi không thể tìm được lá bài thoả mãn.</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>Dĩ nhiên hai quá trình trên sẽ dừng lại sau một số hữu hạn thao tác. Khi đó, ta nhận được chính xác một dãy tăng liên tục $x-i,x-i+1,\ldots,x,\ldots,x+j-1,x+j$. Có thể xem đây là một dãy con của dãy $1,2,\ldots,n$.</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>Tiếp tục chọn bất kì một lá $y$ (nếu có thể) và thực hiện hai hành động tương tự như lá $x$. Kết quả nhận được sau toàn bộ thao tác (chọn và tìm) chính là các dãy con, tăng và liên tục của dãy $1,2,\ldots,n$. Hơn nữa, chúng chính là một phân hoạch của $1,2,\ldots,n$.</span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### $a$-chẻ bài {#sec-a-shuffle}</span></span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>Có nhiều mô tả tương đương (theo nghĩa cùng cho ra một phân phối của các hoán vị) cho phương pháp $a$-chẻ bài, một tổng quát hoá của phương pháp chẻ bài thông thường. Ta sẽ xem xét một số hướng tiếp cận phương pháp này.</span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>Với $a$ là một số nguyên dương. Chia bộ bài gồm $n$ lá bài thành $a$ phần, mỗi phần có số lá bài lần lượt là $l_{1},l_{2},\ldots,l_{a}$, trong đó $l_{i}\ge0$ với mọi $i=1,2,\ldots,a$ và $l_{1}+l_{2}+\ldots+l_{a}=n$. Sau đó xen kẽ các lá bài của $a$ phần này với nhau, theo nghĩa, gộp $a$ phần lại thành một bộ bài sao cho thứ tự tương đối của các lá bài trong mỗi phần không thay đổi.</span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>Hành động phân chia bộ bài bên trên tuân theo phân phối đa thức (một phiên bản tổng quát của phân phối nhị thức). Nói cách khác, xác suất để các phần có số lá bài lần lượt là $l_{1},l_{2},\ldots,l_{a}$, chính bằng</span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>\binom{n}{l_{1},l_{2},\ldots,l_{a}}a^{-n}=\frac{n!}{l_{1}!l_{2}!\cdots l_{a}!}a^{-n}.</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>Ta thực hiện tiếp tục xen kẽ $a$ phần này theo cách, mỗi lần, thả một lá bài ở dưới cùng của một phần nào đó (lá bài được thả ở lần ngay sau đó nằm ngay trên lá bài vừa được thả ở lần trước), trong đó khả năng để lá bài được thả xuống ở một lần nào đó đến từ phần $i$ là</span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>\frac{l_{i}}{l_{1}+l_{2}+\ldots+l_{a}}.</span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>$$ {#eq-prop_prob}</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>Ở mỗi lần, biểu thức (<span class="co">[</span><span class="ot">-@eq-prop_prob</span><span class="co">]</span>) sẽ được cập nhật dựa trên sự thay đổi của số lá bài hiện có trong mỗi phần. Đơn cử, xét trường hợp các lá bài trong mỗi phần được thả liên tiếp, lần lượt từ phần $1$ đến phần $a$. Khi đó xác suất của $l_{1}$ lần thả đầu tiên là</span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>\frac{l_{1}}{n}\cdot\frac{l_{1}-1}{n-1}\cdots\frac{1}{n-l_{1}+1}=\frac{l_{1}\left(l_{1}-1\right)\cdots1}{n\left(n-1\right)\cdots\left(n-l_{1}+1\right)}.</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>Tương tự, xác suất của $n-l_{1}$ lần thả còn lại là</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>\prod_{i=2}^{a}\frac{l_{i}\left(l_{i}-1\right)\cdots1}{\left(n-l_{1}-l_{2}-\ldots-l_{i-1}\right)\left(n-l_{1}-l_{2}-\ldots-l_{i-1}-1\right)\cdots\left(n-l_{1}-l_{2}-\ldots-l_{i}+1\right)}.</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>Nhớ rằng $l_{1}+l_{2}+\ldots+l_{a}=n$. Như vậy xác suất của toàn bộ quá trình thả bài, chính bằng</span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>\frac{\left(l_{1}\left(l_{1}-1\right)\cdots1\right)\left(l_{2}\left(l_{2}-1\right)\cdots1\right)\cdots\left(l_{a}\left(l_{a}-1\right)\cdots1\right)}{n\left(n-1\right)\cdots1}=\frac{l_{1}!l_{2}!\cdots l_{a}!}{n!}.</span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>$$ {#eq-drop}</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>Trong trường hợp thứ tự của các lá bài của $a$ phần trong các lần thả thay đổi, xác suất cuối cùng vẫn giữ nguyên. Bởi, khi ta thay đổi thứ tự thả xuống của hai lá bài, bản chất chỉ là đang thay đổi thứ tự các nhân tử ở tử số của phân thức (<span class="co">[</span><span class="ot">-@eq-drop</span><span class="co">]</span>).</span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>Một cách suy diễn tương đương khác để dẫn đến xác suất trên. Đó là sau khi chọn theo phân phối đa thức một cách phân chia bộ bài thành $a$ phần, sau đó lấy lần lượt, bất kỳ, hai phần khác nhau và thực hiện xen kẽ hai phần này thành một bộ, tức xem như chẻ bài thông thường cho một bộ bài. Thao tác tương tự cho những cặp khác. Sau $a-1$ lần thực hiện chẻ bài thông thường cho mỗi bộ hai phần, ta nhận được bộ bài gồm $n$ lá ban đầu. Ta sẽ chứng minh rằng hướng tiếp cận này tương đương với quá trình thả bài phía trên, theo nghĩa, xác suất cuối cùng của hai cách này là như nhau. Thật vậy, giả sử rằng ta chọn các cặp của các phần theo thứ tự: phần $1$ và phần $2$, tiếp theo là phần $1$, $2$ và phần $3$, sau đó là phần $1$, $2$, $3$ và phần $4$,... Tương tự cho đến cặp cuối cùng. Sử dụng công thức xác suất (<span class="co">[</span><span class="ot">-@eq-R2</span><span class="co">]</span>), ta nhận được xác suất của toàn bộ $a-1$ lần thực hiện chẻ bài thông thường là</span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{=tex}</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{align*}</span></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a><span class="in">&amp;\binom{l_{1}+l_{2}}{l_{2}}^{-1}\binom{l_{1}+l_{2}+l_{3}}{l_{3}}^{-1}\cdots\binom{l_{1}+l_{2}+\ldots+l_{a}}{l_{a}}^{-1}\\</span></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a><span class="in">=&amp;\left(\frac{\left(l_{1}+l_{2}\right)!}{l_{1}!l_{2}!}\cdot\frac{\left(l_{1}+l_{2}+l_{3}\right)!}{\left(l_{1}+l_{2}\right)!l_{3}!}\cdots\frac{\left(l_{1}+l_{2}+\ldots+l_{a}\right)!}{\left(l_{1}+l_{2}+\ldots+l_{a-1}\right)!l_{a}!}\right)^{-1}\\</span></span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a><span class="in">=&amp;\left(\frac{\left(l_{1}+l_{2}+\ldots+l_{a}\right)!}{l_{1}!l_{2}!\cdots l_{a}!}\right)^{-1}\\</span></span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a><span class="in">=&amp;\frac{l_{1}!l_{2}!\cdots l_{a}!}{n!}.</span></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a><span class="in">\end{align*}</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>Như vậy hai cách tiếp cận trên là tương đương. Cuối cùng, xác suất để chọn được một cách phân chia và xen kẽ thoả mãn các điều kiện phía trên, chính là</span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>\binom{n}{l_{1},l_{2},\ldots,l_{a}}a^{-n}\cdot\frac{l_{1}!l_{2}!\cdots l_{a}!}{n!}=\frac{1}{a^{n}}.</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>$$ {#eq-a_uni}</span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>Như vậy, mỗi cặp phân chia - xen kẽ ở phương pháp $a$-chẻ bài cũng tuân theo phân phối đều và bản chất cũng là một lần xáo bài. Ta gọi phương pháp $a$-chẻ bài này là $\mathcal{R}_{a}$, với phân phối xác suất $\mathcal{R}_{a}$ tương ứng. Dễ thấy $\mathcal{R}_{2}=\mathcal{R}$, nói cách khác phương pháp chẻ bài thông thường chính là phương pháp $2$-chẻ bài.</span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a><span class="fu">### Định lý nhân và định lý dãy tăng</span></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>::: theorem</span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>Với $a,b$ là các số tự nhiên, thực hiện một lần $a$-chẻ bài và sau đó là một lần $b$-chẻ bài tương đương với việc thực hiện một lần $ab$-chẻ bài. Cụ thể, giả sử $\mathcal{R}_{a}$, $\mathcal{R}_{b}$, $\mathcal{R}_{ab}$ lần lượt là phân phối của $a$-chẻ bài, $b$-chẻ bài, $ab$-chẻ bài. Khi đó $\mathcal{R}_{a}\ast\mathcal{R}_{b}=\mathcal{R}_{ab}$.</span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>::: proof</span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>Xem xét một mô tả tương đương sau của phương pháp $a$-chẻ bài. Phương pháp này có thể được mô tả một cách hình học như việc thả độc lập, ngẫu nhiên theo phân phối đều $n$ điểm vào đoạn thẳng đơn vị $\left<span class="co">[</span><span class="ot">0,1\right</span><span class="co">]</span>$, sau đó tác động ánh xạ $x\mapsto ax\pmod1$, đi từ $\left<span class="co">[</span><span class="ot">0,1\right</span><span class="co">]</span>$ vào chính nó. Ánh xạ này hoán vị $n$ điểm ban đầu và bảo toàn độ đo trên $\left(S_{n},\circ\right)$. Số lượng điểm rơi vào các đoạn $\left<span class="co">[</span><span class="ot">0,\frac{1}{a}\right</span><span class="co">]</span>$, $\left<span class="co">[</span><span class="ot">\frac{1}{a},\frac{2}{a}\right</span><span class="co">]</span>$, ..., $\left<span class="co">[</span><span class="ot">\frac{a-1}{a},1\right</span><span class="co">]</span>$ tuân theo phân phối đa thức. Định lý được chứng minh nhờ tính chất sau</span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>b\left(ax<span class="sc">\!</span>\pmod1\right)<span class="sc">\!</span>\pmod1=abx<span class="sc">\!</span>\pmod1.</span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>Vì một lần chẻ bài thông thường là một lần $2$-chẻ bài, do đó thay vì cố gắng xác định chính xác tích chập $\mathcal{R}^{(k)}$ của $k$ lần phân phối $\mathcal{R}$, ta chỉ cần tính toán cho một lần $2^{k}$-chẻ bài duy nhất, ứng với phân phối $\mathcal{R}_{2^{k}}$.</span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>::: theorem</span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>Xác suất nhận được hoán vị $\pi\in S_{n}$ khi thực hiện một lần $a$-chẻ bài là</span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>\frac{1}{a^{n}}\binom{a+n-r_{\pi}}{n},</span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>$$ với $r_{\pi}$ là số dãy tăng trong $\pi$.</span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>::: proof</span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>Giả sử ta nhận được hoán vị $\pi$ sau một lần $a$-chẻ bài, tức là sau một lần phân chia và một lần xen kẽ nào đó. Xét một cách phân chia trong số đó, lúc này chỉ có duy nhất một cách để cách xen kẽ $a$ phần này lại với nhau (vì với bất kì cách chia nào của bộ bài, ta chỉ cần thả các lá bài ở $a$ phần theo thứ tự của hoán vị $\pi$). Ta đếm số cách phân chia bộ bài thành $a$ phần mà sau đó có thể xen kẽ lại với nhau và nhận được hoán vị $\pi$. Nếu có $r_{\pi}$ dãy tăng trong $\pi$, ta biết được chắc chắn $r_{\pi}-1$ trong số $a-1$ nhát cắt để đảm bảo nhận được hoán vị $\pi$ sau khi xen kẽ. Ta chọn vị trí của $a-1-\left(r_{\pi}-1\right)=a-r_{\pi}$ nhát cắt còn lại giữa bộ bài $n$ lá, dễ thấy có $\binom{n+a-r_{\pi}}{a-r_{\pi}}$ lựa chọn như vậy (bài toán chia kẹo Euler). Từ (<span class="co">[</span><span class="ot">-@eq-a_uni</span><span class="co">]</span>) ta thấy xác suất xảy ra của mỗi hoán vị là $a^{-n}$. Vậy xác suất để nhận được hoán vị $\pi$, có $r_{\pi}$ dãy tăng, sau khi thực hiện một lần $a$-chẻ bài là</span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>\binom{n+a-r_{\pi}}{a-r_{\pi}}\cdot a^{-n}=\frac{1}{a^{n}}\binom{a+n-r_{\pi}}{n}.</span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>Một lợi thế khác khi ta quan tâm đến các $a$-chẻ bài là sau khi thực hiện một lần $a$-chẻ bài, khả năng xuất hiện của hoán vị $\pi\in S_{n}$ có thể được tính toán chỉ với duy nhất thông tin về số dãy tăng $r_{\pi}$ trong $\pi$.</span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cần ít nhất bao nhiêu lần xáo bài?</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a>Hai định lý quan trọng trên cho ta một công thức để tính phân phối của $k$ lần chẻ bài thông thường, hay một lần $2^{k}$-chẻ bài. Cụ thể, với mỗi hoán vị $\pi\in S_{n}$, ta có</span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>\mathcal{R}^{(k)}(\pi)=\mathcal{R}_{2^{k}}(\pi)=\frac{1}{2^{nk}}\binom{2^{k}+n-r_{\pi}}{n}.</span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>Do đó,</span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>\left\vert\mathcal{R}^{(k)}(\pi)-\mathcal{U}(\pi)\right\vert=\left\vert\frac{1}{2^{nk}}\binom{2^{k}+n-r_{\pi}}{n}-\frac{1}{n!}\right\vert.</span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>Dựa vào định lý dãy tăng, ta chỉ cần nhóm các hoán vị có cùng số dãy tăng và tính toán số các hoán vị trong mỗi nhóm. Gọi $<span class="sc">\!</span>\left\langle n\atop r\right\rangle<span class="sc">\!</span>$ là số hoán vị của tập $\llbracket n\rrbracket$ có $r$ dãy tăng. Như vậy khoảng cách biến phân của $\mathcal{R}^{(k)}$ và $\mathcal{U}$ có thể được viết lại thành</span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert=\frac{1}{2}\sum_{r=1}^{n}<span class="sc">\!</span>\left\langle n\atop r\right\rangle<span class="sc">\!</span>\left\vert\frac{1}{2^{nk}}\binom{2^{k}+n-r}{n}-\frac{1}{n!}\right\vert.</span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>Các số $<span class="sc">\!</span>\left\langle n\atop r\right\rangle<span class="sc">\!</span>$ được gọi là các số Euler. Có thể được xác định qua công thức truy hồi sau, với mỗi $n$ cố định, và $<span class="sc">\!</span>\left\langle n\atop1\right\rangle<span class="sc">\!</span>=1$ thì</span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a><span class="sc">\!</span>\left\langle n\atop r\right\rangle<span class="sc">\!</span>=r^{n}-\sum_{j=1}^{r-1}\binom{n+r-j}{n}<span class="sc">\!</span>\left\langle n\atop j\right\rangle<span class="sc">\!</span>,</span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>với mọi $r\ge2$.</span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>Với $n=52$, khoảng cách biến phân được trực quan hoá qua đồ thị sau</span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.align='center'}</span></span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a><span class="in">library(gmp)</span></span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a><span class="in">dis &lt;- function(k){</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- 52</span></span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a><span class="in">  t &lt;- 0</span></span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a><span class="in">  for (r in 1:n){</span></span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a><span class="in">    t = t + (Eulerian(52,r-1,method=c("lookup.or.store","direct")))*(as.bigq((((1/2)*abs(((1/(2^(n*k)))*(choose((2^k)+n-r,n))) - (1/factorial(n)))))))</span></span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a><span class="in">  return(as.double(t))</span></span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a><span class="in">x_values &lt;- 1:12</span></span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a><span class="in">y_values &lt;- sapply(x_values, dis)</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- data.frame(x = x_values, y = y_values)</span></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df, aes(x = x, y = y)) +</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Số lần chẻ bài", y = "Khoảng cách biến phân") +</span></span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 12, by = 1)) +</span></span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic(base_size = 14) +</span></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.background = element_rect(fill = "#1c1c1d", color = NA),</span></span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.background = element_rect(fill = "#f1efe3", color = NA),</span></span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title = element_text(color = "cyan"),</span></span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text = element_text(color = "cyan")</span></span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = seq(0, 1, by = 0.2), linetype = "dashed", color = "gray") + </span></span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = seq(1, 12, by = 1), linetype = "dashed", color = "gray") +</span></span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linetype = "dotted", linewidth = 1, color = "blue") +</span></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 3, color = "blue")</span></span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>Ta nhận thấy rằng, với $k\le5$ thì $\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert&gt;0.9$. Sau đó giảm rất nhanh, khi $k=6$ là $0.6135496$, khi $k=7$ là $0.334061$, khi $k=8$ là $0.1671586$, và với $k\ge9$, ta có $\left\lVert\mathcal{R}^{(k)}-\mathcal{U}\right\rVert&lt;0.1$. Do vậy, chẻ bài $7$ lần có lẽ là một lựa chọn hợp lý, và có cơ sở toán học.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Quan Phung</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ldlinn">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://discord.com/users/quaned">
      <i class="bi bi-discord" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.facebook.com/quanphung.1603">
      <i class="bi bi-facebook" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/quanphung.1603/">
      <i class="bi bi-instagram" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:youremail@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>